{"status":{"description":"","source_mpi":"","state":"ACTIVE","is_cloned":false,"message_list":[],"resources":{"service_definition_list":[{"port_list":[],"description":"","action_list":[{"description":"System action for creating an application","message_list":[],"uuid":"1e607e45-7730-40e8-8184-bcdd474fd37e","name":"action_create","state":"ACTIVE","critical":false,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"a65f7c7c-ebcf-4c4f-a1cf-3343820419c4","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"6fba9cbb_dag"}],"description":"","message_list":[],"uuid":"b8b80915-c631-4a78-ba59-97657ee6f8fc","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"6fba9cbb_dag","uuid":"a65f7c7c-ebcf-4c4f-a1cf-3343820419c4"},"name":"01945104_runbook"}},{"description":"System action for deleting an application. Deletes created VMs as well","message_list":[],"uuid":"c377edeb-85ee-4f24-a307-b0c306b1e4b8","name":"action_delete","state":"ACTIVE","critical":false,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"736029cc-1810-40ec-986d-570ec7eb47fa","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"8bee20f0_dag"}],"description":"","message_list":[],"uuid":"1f4b2e17-4354-4c08-8bb6-74c8ba0ca573","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"8bee20f0_dag","uuid":"736029cc-1810-40ec-986d-570ec7eb47fa"},"name":"fe42eb38_runbook"}},{"description":"System action for restarting an application","message_list":[],"uuid":"39870bd3-8874-4f9a-95fe-5c3487c10278","name":"action_restart","state":"ACTIVE","critical":false,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"30df78e8-1d0e-4015-bd7e-29fc86c47931","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"04cc6e24_dag"}],"description":"","message_list":[],"uuid":"d669393e-4c59-4fea-8c3a-48dd23805821","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"04cc6e24_dag","uuid":"30df78e8-1d0e-4015-bd7e-29fc86c47931"},"name":"ffd25064_runbook"}},{"description":"System action for starting an application","message_list":[],"uuid":"2573dfd2-8005-461d-8f10-5c1cc74510eb","name":"action_start","state":"ACTIVE","critical":false,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"81fdcfec-9684-4258-acfa-cba90ca5ecdb","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"9d7e4dfb_dag"}],"description":"","message_list":[],"uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"9d7e4dfb_dag","uuid":"81fdcfec-9684-4258-acfa-cba90ca5ecdb"},"name":"ef6acd35_runbook"}},{"description":"System action for stopping an application","message_list":[],"uuid":"5e01d291-b259-486e-ae11-631a7163ab29","name":"action_stop","state":"ACTIVE","critical":false,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"843dd758-1949-4395-82fe-cb54465139eb","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"897e9b24_dag"}],"description":"","message_list":[],"uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"897e9b24_dag","uuid":"843dd758-1949-4395-82fe-cb54465139eb"},"name":"b81e8f8b_runbook"}},{"description":"System action for deleting an application. Does not delete created VMs","message_list":[],"uuid":"80375ab5-3f59-4189-8e08-658d38518a6f","name":"action_soft_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"DAG","uuid":"eeccd0b6-4e7f-421a-97a9-e4aec24d4ce1","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Service_Element_Delete_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"251c1472-88c7-4d4a-96e5-2b5593504f4d"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"SOFT_DELETE_ELEMENT","uuid":"251c1472-88c7-4d4a-96e5-2b5593504f4d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Service_Element_Delete_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"c64c0489-8a38-40e3-ae8c-58e075f7e015","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"eeccd0b6-4e7f-421a-97a9-e4aec24d4ce1"},"name":"SYS_GEN__Runbook_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}}],"message_list":[],"uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","state":"ACTIVE","depends_on_list":[],"editables":{},"tier":"","singleton":false,"variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"fc467edd-a5ee-65a5-0cbb-02b248bdc040","value":"","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"TOKEN"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0c9c619a-6313-4c05-9b8b-94bacf4b1137","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_HOURS"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0bded42a-ebde-1e2f-2f6d-b8cc2c51e315","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_MINUTES"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"72987114-8a60-ffbf-1c75-f89a7d0efad5","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_SECONDS"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"00f318f6-010f-aab2-3085-7e5cce796695","value":"postgresql-9.6","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SERVICE_NAME"}],"name":"Postgres"}],"substrate_definition_list":[{"description":"","action_list":[{"description":"System action for creating an application","message_list":[],"uuid":"c80e5cfd-0c24-4181-956f-af00c774723b","name":"action_create","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"d16f01f2-adf4-48fd-b47f-62c2d2a4523b","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Nutanix_Provision_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"a298d854-4f37-4c2a-9043-ca64049ec368"},{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"37ddbf70-2dc3-4a86-a098-f48503077112"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__Nutanix_Provision_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"a298d854-4f37-4c2a-9043-ca64049ec368"},"edge_type":"inherent","type":"","uuid":"0a09d46f-068d-4882-bd25-11c8754ce4e2","to_task_reference":{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"37ddbf70-2dc3-4a86-a098-f48503077112"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"PROVISION_NUTANIX","uuid":"a298d854-4f37-4c2a-9043-ca64049ec368","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"name":"lin-@@{calm_array_index}@@-@@{calm_time}@@","categories":"","availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"efc034e3-b50e-4a48-b02d-25036aeb8bd3"},"type":""}],"parent_reference":null,"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"serial_port_list":[],"gpu_list":[],"memory_size_mib":8192,"power_state":"ON","hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{db_server_cred.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"type":"","boot_config":{"boot_device":{"type":"","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"Centos-7.4-1801-01","uuid":"96e7ffa6-6457-4932-a9e8-ba009cd88ddf"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":1,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":2,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":3,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":4,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":5,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":6,"type":""}}}]}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Nutanix_Provision_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CHECK_LOGIN","uuid":"37ddbf70-2dc3-4a86-a098-f48503077112","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"retries":"5","dial_timeout":"","timeout":"60","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","type":"CHECK_LOGIN","sleep_time":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"468bde9f-f935-4f7b-8af6-3cd0c6289ddd","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"d16f01f2-adf4-48fd-b47f-62c2d2a4523b"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for powering on an application","message_list":[],"uuid":"20ae44cf-f7ab-42b6-befe-5c62a4e5fe37","name":"action_poweron","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"34825aa1-f604-4ed6-9e6b-f0e91d09ee0e","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Nutanix_Operation_PowerOn_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"0a6f61f2-531d-42d3-9ce4-65b514369b35"},{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"7db34c9e-4c64-48c2-9204-9933e61c17b8"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__Nutanix_Operation_PowerOn_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"0a6f61f2-531d-42d3-9ce4-65b514369b35"},"edge_type":"inherent","type":"","uuid":"04af1e16-fbc1-4b0c-b22f-7bd3fd0ef23b","to_task_reference":{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"7db34c9e-4c64-48c2-9204-9933e61c17b8"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"VMOPERATION_NUTANIX","uuid":"0a6f61f2-531d-42d3-9ce4-65b514369b35","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":"GENERIC_OPERATION"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Nutanix_Operation_PowerOn_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CHECK_LOGIN","uuid":"7db34c9e-4c64-48c2-9204-9933e61c17b8","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"retries":"5","dial_timeout":"","timeout":"60","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","type":"CHECK_LOGIN","sleep_time":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"4f59b07b-0aed-48d1-a1de-03b8ce5aa6ea","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"34825aa1-f604-4ed6-9e6b-f0e91d09ee0e"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for restarting an application","message_list":[],"uuid":"ae684746-06df-4d2c-9079-fec257245221","name":"action_restart","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"314767e2-7135-4704-ab1f-bfafa68c3f23","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Nutanix_Operation_Restart_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"c07581f5-c63f-4ac8-abb8-6cfc0b4a576d"},{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"d4d3aa98-6e14-4f63-9b6e-751631960048"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__Nutanix_Operation_Restart_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"c07581f5-c63f-4ac8-abb8-6cfc0b4a576d"},"edge_type":"inherent","type":"","uuid":"72a60dcd-bd51-419a-8f58-1d080ee2a9fa","to_task_reference":{"kind":"app_task","name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"d4d3aa98-6e14-4f63-9b6e-751631960048"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"VMOPERATION_NUTANIX","uuid":"c07581f5-c63f-4ac8-abb8-6cfc0b4a576d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":"GENERIC_OPERATION"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Nutanix_Operation_Restart_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CHECK_LOGIN","uuid":"d4d3aa98-6e14-4f63-9b6e-751631960048","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"retries":"5","dial_timeout":"","timeout":"60","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","type":"CHECK_LOGIN","sleep_time":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__check_login_for_PostgreSQL_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"728eb749-6862-4505-a2d3-10dbc9b7e40a","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"314767e2-7135-4704-ab1f-bfafa68c3f23"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for suspending an application","message_list":[],"uuid":"f2e9d5da-9813-4503-a377-1dde5451f746","name":"action_suspend","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"a145f0ed-6e6b-4338-9905-59444754f51d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"fcd5cb07-513d-47b8-9fbc-e6103b8e0346","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"a145f0ed-6e6b-4338-9905-59444754f51d"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for modifying an application","message_list":[],"uuid":"17d30228-cda2-4ad1-82eb-46c5cd061064","name":"action_modify","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"4187e763-bd94-44c3-b028-1198611105c9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"0bea6476-961f-4fd3-a7f7-45b7df4f1a52","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"4187e763-bd94-44c3-b028-1198611105c9"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for powering off an application","message_list":[],"uuid":"4a5c1019-a4a9-410d-a94b-c12fd2125bd5","name":"action_poweroff","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"1f1caf92-751d-4c53-b13a-0869db362755","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Nutanix_Operation_PowerOff_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"eb6566b6-ffc2-41b8-92a6-b31489c9d68b"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"VMOPERATION_NUTANIX","uuid":"eb6566b6-ffc2-41b8-92a6-b31489c9d68b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":"GENERIC_OPERATION"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Nutanix_Operation_PowerOff_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"2629ff55-0238-49c4-a500-817bc64a1085","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"1f1caf92-751d-4c53-b13a-0869db362755"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for deleting an application. Deletes created VMs as well","message_list":[],"uuid":"3af17917-96f1-488a-86d7-fc47199a1236","name":"action_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"69757d25-2e2b-490f-93c6-364d14c3c4fa","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Nutanix_Delete_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"41a73a27-3638-4681-9925-adddbde00238"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DELETE_NUTANIX","uuid":"41a73a27-3638-4681-9925-adddbde00238","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Nutanix_Delete_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"1e6143e5-0549-46ea-8ed9-afc20d7f89c9","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"69757d25-2e2b-490f-93c6-364d14c3c4fa"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"System action for deleting an application. Does not delete created VMs","message_list":[],"uuid":"681dcbd2-624e-4d18-a674-308f11b0bbed","name":"action_soft_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"d2f02b68-3b2a-4ec5-a63f-696c02a55a15","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Substrate_Element_Delete_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"77577966-d190-46a2-a4ae-e32c80d23db4"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"SOFT_DELETE_ELEMENT","uuid":"77577966-d190-46a2-a4ae-e32c80d23db4","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Substrate_Element_Delete_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"74700936-4913-4288-8f1a-78e30542f367","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"d2f02b68-3b2a-4ec5-a63f-696c02a55a15"},"name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}},{"description":"","message_list":[],"uuid":"3f5bb9c2-9388-d7d6-1026-759244b075d2","name":"pre_action_create","state":"ACTIVE","critical":false,"attrs":{},"type":"fragment","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"72560c7d-15c0-6cf1-8b42-b1c779a0d982","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"4b0c18f5_dag"}],"description":"","message_list":[],"uuid":"f9fc2966-0383-3f2f-c1e8-9be354c318fe","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"4b0c18f5_dag","uuid":"72560c7d-15c0-6cf1-8b42-b1c779a0d982"},"name":"8e143af6_runbook"}},{"description":"","message_list":[],"uuid":"492bf4fd-713d-988f-c3a6-296e0e801cc8","name":"post_action_delete","state":"ACTIVE","critical":false,"attrs":{},"type":"fragment","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"DAG","uuid":"379ef25c-90f1-dd20-66ee-efa0c652902c","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"9fd599cd_dag"}],"description":"","message_list":[],"uuid":"9c19d663-f9e3-20e7-e0a6-267f8768ee87","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"9fd599cd_dag","uuid":"379ef25c-90f1-dd20-66ee-efa0c652902c"},"name":"bd422cbf_runbook"}}],"message_list":[],"uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4","state":"ACTIVE","readiness_probe":{"connection_type":"SSH","retries":"5","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"editables":{"readiness_probe":{"connection_type":true,"retries":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"guest_customization":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}},"categories":true,"name":true}},"os_type":"Linux","type":"AHV_VM","create_spec":{"name":"lin-@@{calm_array_index}@@-@@{calm_time}@@","categories":"","availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"efc034e3-b50e-4a48-b02d-25036aeb8bd3"},"type":""}],"parent_reference":null,"guest_tools":null,"num_vcpus_per_socket":2,"num_sockets":2,"serial_port_list":[],"gpu_list":[],"memory_size_mib":8192,"power_state":"ON","hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{db_server_cred.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"},"type":"","sysprep":null},"type":"","boot_config":{"boot_device":{"type":"","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"Centos-7.4-1801-01","uuid":"96e7ffa6-6457-4932-a9e8-ba009cd88ddf"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":0,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":1,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":2,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":3,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":4,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":5,"type":""}}},{"data_source_reference":null,"type":"","disk_size_mib":8192,"volume_group_reference":null,"device_properties":{"type":"","device_type":"DISK","disk_address":{"adapter_type":"SCSI","device_index":6,"type":""}}}]}},"variable_list":[],"name":"PostgreSQL"}],"credential_definition_list":[{"username":"centos","description":"","state":"ACTIVE","message_list":[],"uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"editables":{"username":true,"secret":true},"type":"KEY","name":"db_server_cred"},{"username":"admin","description":"","state":"ACTIVE","message_list":[],"uuid":"6f127226-e987-443c-ac4c-daa9796b9af8","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"editables":{"username":true,"secret":true},"type":"PASSWORD","name":"era_web_cred"}],"type":"USER","app_profile_list":[{"deployment_create_list":[{"description":"","action_list":[{"description":"System action for creating an application","message_list":[],"uuid":"61fd62cb-5e3e-486f-b875-e09952353840","name":"action_create","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"d177df51-9e4d-4449-8bb3-07814d68325d","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"c09e23af-1989-452a-a03f-7aa450c4ea7a"},{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5dedbd27-52de-4eff-a09a-477146f819b5"},{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"35f6ea4f-2fa6-4e50-bf0e-78bdaa3a75f0"},{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2574497d-f35a-4eb1-857b-ca350998298d"},{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8086d1af-0eb3-4fce-9cc1-c624c7485f25"},{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"5a89cca8-c583-42cd-9437-05ee766ff19e"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8086d1af-0eb3-4fce-9cc1-c624c7485f25"},"edge_type":"inherent","type":"","uuid":"6ba8e561-da16-4033-b6fb-2cdfcf5c23d9","to_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"5a89cca8-c583-42cd-9437-05ee766ff19e"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2574497d-f35a-4eb1-857b-ca350998298d"},"edge_type":"inherent","type":"","uuid":"61d96972-4bc4-4580-8696-825bfbf7944c","to_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8086d1af-0eb3-4fce-9cc1-c624c7485f25"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5dedbd27-52de-4eff-a09a-477146f819b5"},"edge_type":"inherent","type":"","uuid":"b4f707eb-ab98-49e2-acb7-2b4cc6b4ff35","to_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"35f6ea4f-2fa6-4e50-bf0e-78bdaa3a75f0"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"35f6ea4f-2fa6-4e50-bf0e-78bdaa3a75f0"},"edge_type":"inherent","type":"","uuid":"0459f423-bd08-4a67-91b5-4b9199575efc","to_task_reference":{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2574497d-f35a-4eb1-857b-ca350998298d"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"c09e23af-1989-452a-a03f-7aa450c4ea7a"},"edge_type":"inherent","type":"","uuid":"64d38366-6bba-4a39-9bdc-613164078ef2","to_task_reference":{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5dedbd27-52de-4eff-a09a-477146f819b5"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"CREATE_DEPLOYMENT_ELEMENT","uuid":"c09e23af-1989-452a-a03f-7aa450c4ea7a","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"5dedbd27-52de-4eff-a09a-477146f819b5","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"8e143af6_runbook","uuid":"f9fc2966-0383-3f2f-c1e8-9be354c318fe"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"35f6ea4f-2fa6-4e50-bf0e-78bdaa3a75f0","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"468bde9f-f935-4f7b-8af6-3cd0c6289ddd"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"2574497d-f35a-4eb1-857b-ca350998298d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"24e07ac7-7136-483f-8968-e08f54a48741"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"8086d1af-0eb3-4fce-9cc1-c624c7485f25","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"01945104_runbook","uuid":"b8b80915-c631-4a78-ba59-97657ee6f8fc"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"5a89cca8-c583-42cd-9437-05ee766ff19e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"70a43bfd-955c-42b7-9517-13035b1987ed","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"d177df51-9e4d-4449-8bb3-07814d68325d"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for starting an application","message_list":[],"uuid":"28f951dd-f363-4b0a-8f43-d67691328b74","name":"action_start","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"b679bc2b-a243-43b8-afa9-e2b2fb41f961","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"47366ddc-04df-422d-8788-9e2a8615ea45"},{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"0fdac945-80d8-4d39-995f-58ddbdb5ebdf"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"47366ddc-04df-422d-8788-9e2a8615ea45"},"edge_type":"inherent","type":"","uuid":"737da16b-3d33-4367-bf45-2ea7f257b19d","to_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"0fdac945-80d8-4d39-995f-58ddbdb5ebdf"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"47366ddc-04df-422d-8788-9e2a8615ea45","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"4f59b07b-0aed-48d1-a1de-03b8ce5aa6ea"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"0fdac945-80d8-4d39-995f-58ddbdb5ebdf","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"750d8d96-721b-4df1-966e-88dfe1b82ecb","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"b679bc2b-a243-43b8-afa9-e2b2fb41f961"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for restarting an application","message_list":[],"uuid":"0652e1a6-b01d-412a-b165-f1f1e804ddd4","name":"action_restart","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"935100e2-9623-400e-8159-9d7c5adfdcd3","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"57b7a22b-01d4-47a5-9695-dfb3aaea617d"},{"kind":"app_task","name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"92523b1a-ef18-4437-843e-d065c500a9ff"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"57b7a22b-01d4-47a5-9695-dfb3aaea617d"},"edge_type":"inherent","type":"","uuid":"22af19ad-86c2-488e-abe6-c7d7313d05a5","to_task_reference":{"kind":"app_task","name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"92523b1a-ef18-4437-843e-d065c500a9ff"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"57b7a22b-01d4-47a5-9695-dfb3aaea617d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"728eb749-6862-4505-a2d3-10dbc9b7e40a"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"92523b1a-ef18-4437-843e-d065c500a9ff","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ffd25064_runbook","uuid":"d669393e-4c59-4fea-8c3a-48dd23805821"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"96abefa9-270c-461b-b98f-52c561ec188b","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"935100e2-9623-400e-8159-9d7c5adfdcd3"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for stopping an application","message_list":[],"uuid":"734b4c8f-b94b-4cf0-a740-bebd53b0f6f5","name":"action_stop","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"385de49a-cbb5-46ff-b676-f7c365f92b54","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"b3c8d4f3-a713-409e-a901-09483674d3c7"},{"kind":"app_task","name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"4458fc9b-12ec-48e1-9427-89ee52b1b8d5"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"b3c8d4f3-a713-409e-a901-09483674d3c7"},"edge_type":"inherent","type":"","uuid":"428b28bd-6b20-4759-a8fe-a2d8e4c00f51","to_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"4458fc9b-12ec-48e1-9427-89ee52b1b8d5"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"b3c8d4f3-a713-409e-a901-09483674d3c7","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"4458fc9b-12ec-48e1-9427-89ee52b1b8d5","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"2629ff55-0238-49c4-a500-817bc64a1085"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"c1af4454-1ec4-4bca-9dbf-109214ec739f","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"385de49a-cbb5-46ff-b676-f7c365f92b54"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for deleting an application. Deletes created VMs as well","message_list":[],"uuid":"90e25fa6-4e1d-4aca-95b3-8593798f8352","name":"action_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"81318837-ddb2-4b31-bab8-7fc13de87da4","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"f41a3e63-70f5-4554-b6c4-32815ae5799d"},{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"ac7dc649-88c8-495e-b5de-d72fe1ba52c8"},{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"84a6756d-8036-407b-9752-c20a3c2f407f"},{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"2008d56e-444f-43c3-9f28-82be14797813"},{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"be421006-a84e-4e86-a7c2-984c2f14ef02"},{"kind":"app_task","name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"6d63b057-1c71-4dc2-b6d9-1f34182f2ad1"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"f41a3e63-70f5-4554-b6c4-32815ae5799d"},"edge_type":"inherent","type":"","uuid":"73c3385d-d0f6-42c8-bb4e-03b64dd4479c","to_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"ac7dc649-88c8-495e-b5de-d72fe1ba52c8"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"ac7dc649-88c8-495e-b5de-d72fe1ba52c8"},"edge_type":"inherent","type":"","uuid":"75b37bd3-65fa-42a0-97bd-ad14b2ed983c","to_task_reference":{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"84a6756d-8036-407b-9752-c20a3c2f407f"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"2008d56e-444f-43c3-9f28-82be14797813"},"edge_type":"inherent","type":"","uuid":"01cc8fb8-9ab9-4437-8cd5-ca6239ba2ec7","to_task_reference":{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"be421006-a84e-4e86-a7c2-984c2f14ef02"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"84a6756d-8036-407b-9752-c20a3c2f407f"},"edge_type":"inherent","type":"","uuid":"cfddfbcf-f46f-4673-b2b2-4b3f0ee5121b","to_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"2008d56e-444f-43c3-9f28-82be14797813"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"be421006-a84e-4e86-a7c2-984c2f14ef02"},"edge_type":"inherent","type":"","uuid":"722ea785-fd9b-44b1-be06-f06656bbff5f","to_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"6d63b057-1c71-4dc2-b6d9-1f34182f2ad1"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"f41a3e63-70f5-4554-b6c4-32815ae5799d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"ac7dc649-88c8-495e-b5de-d72fe1ba52c8","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"fe42eb38_runbook","uuid":"1f4b2e17-4354-4c08-8bb6-74c8ba0ca573"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"84a6756d-8036-407b-9752-c20a3c2f407f","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"52aa9058-c314-484e-ad98-b4cadc28e7ae"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"2008d56e-444f-43c3-9f28-82be14797813","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"1e6143e5-0549-46ea-8ed9-afc20d7f89c9"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"be421006-a84e-4e86-a7c2-984c2f14ef02","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"bd422cbf_runbook","uuid":"9c19d663-f9e3-20e7-e0a6-267f8768ee87"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DELETE_DEPLOYMENT_ELEMENT","uuid":"6d63b057-1c71-4dc2-b6d9-1f34182f2ad1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"07de1386-f918-4ff9-83ab-654ba8774d5c","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"81318837-ddb2-4b31-bab8-7fc13de87da4"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for scaleout","message_list":[],"uuid":"31536f0b-3fb1-491e-baf9-f52e764371ea","name":"action_scaleout","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"d5478917-3dd2-4fde-9369-c62ba9cd4ec7","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Deployment_Scaleout_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"5af28058-45e2-4f12-a516-d9b7aa26dcef"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"SCALING","uuid":"5af28058-45e2-4f12-a516-d9b7aa26dcef","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"scaling_count":"@@{scaling_count}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Deployment_Scaleout_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"fb34a48b-aa3d-4015-9669-f7677d0543ed","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"2345e7b9-809c-4923-9e5d-e36aafc0a2af","value":"0","label":"","state":"NOT_VALIDATED","attrs":{},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"scaling_count"}],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"d5478917-3dd2-4fde-9369-c62ba9cd4ec7"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for scalein","message_list":[],"uuid":"9faf16c6-03ed-4753-b18b-dc9ccd29d40b","name":"action_scalein","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"d80afe18-9251-43b6-8d08-68060640ddcc","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Deployment_Scalein_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"81290806-0880-4889-bbe6-42f75846e0a5"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"SCALING","uuid":"81290806-0880-4889-bbe6-42f75846e0a5","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"scaling_count":"@@{scaling_count}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Deployment_Scalein_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"6b7eb186-a255-47bf-848d-598944a597b0","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"4b879792-4616-4fc2-8be7-d8d5fe35d5f1","value":"0","label":"","state":"NOT_VALIDATED","attrs":{},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"scaling_count"}],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"d80afe18-9251-43b6-8d08-68060640ddcc"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}},{"description":"System action for deleting an application. Does not delete created VMs","message_list":[],"uuid":"4272c62c-5eeb-4467-af3b-ced5d08c593f","name":"action_soft_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DAG","uuid":"4226baa6-8444-4bb6-af43-bf971e7063fb","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"146cc7a5-c823-4422-b73e-45a0f10d2498"},{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2790855d-750c-46bd-ab19-11e4ea785fee"},{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"fde03577-988c-4497-9edd-fec48646e5e1"},{"kind":"app_task","name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"fc6622f6-6703-4ae2-95f6-3a456f625120"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"146cc7a5-c823-4422-b73e-45a0f10d2498"},"edge_type":"inherent","type":"","uuid":"1a74e53e-0a26-4be1-8d4d-2b0c924bf4ca","to_task_reference":{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2790855d-750c-46bd-ab19-11e4ea785fee"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"fde03577-988c-4497-9edd-fec48646e5e1"},"edge_type":"inherent","type":"","uuid":"cfd4d5b9-132b-46f4-8fa1-caafec3f3b10","to_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"fc6622f6-6703-4ae2-95f6-3a456f625120"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"2790855d-750c-46bd-ab19-11e4ea785fee"},"edge_type":"inherent","type":"","uuid":"e1ee64c0-fc6d-4ce1-873f-1492ccfe4023","to_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"fde03577-988c-4497-9edd-fec48646e5e1"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"146cc7a5-c823-4422-b73e-45a0f10d2498","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"c64c0489-8a38-40e3-ae8c-58e075f7e015"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"SOFT_DELETE_ELEMENT","uuid":"2790855d-750c-46bd-ab19-11e4ea785fee","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"fde03577-988c-4497-9edd-fec48646e5e1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"74700936-4913-4288-8f1a-78e30542f367"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"SOFT_DELETE_DEPLOYMENT_ELEMENT","uuid":"fc6622f6-6703-4ae2-95f6-3a456f625120","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"904fa9b5-cd3b-46d6-95ac-27fb3183d9f2","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"4226baa6-8444-4bb6-af43-bf971e7063fb"},"name":"SYS_GEN__Runbook_Deployment_55d915ec_e34e_4bd5_aa49_1f070f437760"}}],"message_list":[],"published_service_local_reference_list":[],"uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760","min_replicas":"1","state":"ACTIVE","max_replicas":"1","depends_on_list":[],"editables":{"min_replicas":true,"max_replicas":true},"package_local_reference_list":[{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"}],"substrate_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"type":"GREENFIELD","options":{},"variable_list":[],"name":"f6be2786_deployment"}],"description":"","action_list":[{"description":"System action for creating an application","message_list":[],"uuid":"5c333286-1583-4342-9278-c42138d05b45","name":"action_create","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"3cfe7a52-0c79-4583-8a76-22ef198ca22e","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"631f9547-1cb3-4857-8687-84f01b4b6c39"},{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5985ecb6-ae0f-4e3f-bb80-6da988560a12"},{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"043fa1f4-e19b-46f8-a094-497af1a188c0"},{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"dc4f707b-4a6e-425b-8d04-77022cca113d"},{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8533b1f6-3aca-4982-ab4c-65a63925d84f"},{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"f0b8cafa-e1af-47a3-894a-c386bfa40d13"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8533b1f6-3aca-4982-ab4c-65a63925d84f"},"edge_type":"inherent","type":"","uuid":"4d2ddf99-c3ea-4e73-9fd5-0facc2938240","to_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"f0b8cafa-e1af-47a3-894a-c386bfa40d13"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"dc4f707b-4a6e-425b-8d04-77022cca113d"},"edge_type":"inherent","type":"","uuid":"1c060737-7246-44b5-b1eb-f21d56706889","to_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"8533b1f6-3aca-4982-ab4c-65a63925d84f"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5985ecb6-ae0f-4e3f-bb80-6da988560a12"},"edge_type":"inherent","type":"","uuid":"21d06708-4d0e-4973-a1f9-4d1ae4903165","to_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"043fa1f4-e19b-46f8-a094-497af1a188c0"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"043fa1f4-e19b-46f8-a094-497af1a188c0"},"edge_type":"inherent","type":"","uuid":"7e856647-8ed5-497d-af91-380675cdb95f","to_task_reference":{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"dc4f707b-4a6e-425b-8d04-77022cca113d"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"631f9547-1cb3-4857-8687-84f01b4b6c39"},"edge_type":"inherent","type":"","uuid":"a620fad6-f672-47de-8760-4bbc90a4641c","to_task_reference":{"kind":"app_task","name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5985ecb6-ae0f-4e3f-bb80-6da988560a12"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"CREATE_DEPLOYMENT_ELEMENT","uuid":"631f9547-1cb3-4857-8687-84f01b4b6c39","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Provision_55d915ec_e34e_4bd5_aa49_1f070f437760"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"5985ecb6-ae0f-4e3f-bb80-6da988560a12","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"8e143af6_runbook","uuid":"f9fc2966-0383-3f2f-c1e8-9be354c318fe"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__pre_create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"043fa1f4-e19b-46f8-a094-497af1a188c0","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"468bde9f-f935-4f7b-8af6-3cd0c6289ddd"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__create_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"dc4f707b-4a6e-425b-8d04-77022cca113d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"24e07ac7-7136-483f-8968-e08f54a48741"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"8533b1f6-3aca-4982-ab4c-65a63925d84f","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"01945104_runbook","uuid":"b8b80915-c631-4a78-ba59-97657ee6f8fc"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"f0b8cafa-e1af-47a3-894a-c386bfa40d13","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"6b90194f-f5e8-462d-a0ef-e3de747d36a1","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"3cfe7a52-0c79-4583-8a76-22ef198ca22e"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"System action for starting an application","message_list":[],"uuid":"09cb2654-c4f7-4993-bd3b-2c9b1b8ab3ff","name":"action_start","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"ba70aef3-b3da-4cca-8228-a77cacf4ec27","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"bd97e229-66f8-4d75-b984-f9aa21126a29"},{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"ee8cdc10-acfb-4b4d-9bb2-0a38d033cc59"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"bd97e229-66f8-4d75-b984-f9aa21126a29"},"edge_type":"inherent","type":"","uuid":"a328641c-f9a4-4af0-9f77-aaa4cc135eb7","to_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"ee8cdc10-acfb-4b4d-9bb2-0a38d033cc59"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"bd97e229-66f8-4d75-b984-f9aa21126a29","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"4f59b07b-0aed-48d1-a1de-03b8ce5aa6ea"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"ee8cdc10-acfb-4b4d-9bb2-0a38d033cc59","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"3cbf3f3b-b21c-464e-bc45-13988854b3ce","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"ba70aef3-b3da-4cca-8228-a77cacf4ec27"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"System action for restarting an application","message_list":[],"uuid":"e1926814-d7f9-4aa9-9f49-40638e5b617b","name":"action_restart","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"bd37bb88-62c3-4b42-8cd3-0f5487131235","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"b5c02592-4ea2-4f1b-90a7-94c42de018c1"},{"kind":"app_task","name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"cd8297b7-f49c-4c44-8fc1-429698b93105"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"b5c02592-4ea2-4f1b-90a7-94c42de018c1"},"edge_type":"inherent","type":"","uuid":"5789dd48-4896-440a-9125-ee3ab2998957","to_task_reference":{"kind":"app_task","name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"cd8297b7-f49c-4c44-8fc1-429698b93105"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"b5c02592-4ea2-4f1b-90a7-94c42de018c1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"728eb749-6862-4505-a2d3-10dbc9b7e40a"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__restart_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"cd8297b7-f49c-4c44-8fc1-429698b93105","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ffd25064_runbook","uuid":"d669393e-4c59-4fea-8c3a-48dd23805821"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"41d3e0ba-9ae8-4afe-94a5-eaad55790c8f","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"bd37bb88-62c3-4b42-8cd3-0f5487131235"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"System action for stopping an application","message_list":[],"uuid":"433e0ec2-834f-413b-a2de-db9245fce88f","name":"action_stop","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"3db4edaf-1ade-413b-b9fe-baf3d9bdcb27","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"c8fcc551-c01e-439c-97ca-421bb59cd696"},{"kind":"app_task","name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"fdc505ce-e64c-451a-89f5-a6af6245631e"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"c8fcc551-c01e-439c-97ca-421bb59cd696"},"edge_type":"inherent","type":"","uuid":"07ea7963-ed9d-464c-ac32-7c31c9e417cb","to_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"fdc505ce-e64c-451a-89f5-a6af6245631e"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"c8fcc551-c01e-439c-97ca-421bb59cd696","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"fdc505ce-e64c-451a-89f5-a6af6245631e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"2629ff55-0238-49c4-a500-817bc64a1085"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"}],"description":"","message_list":[],"uuid":"81b586c4-9f41-43d3-b6fb-df8701cc3987","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"3db4edaf-1ade-413b-b9fe-baf3d9bdcb27"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"System action for deleting an application. Deletes created VMs as well","message_list":[],"uuid":"199b94ce-ae2d-41f7-ad2f-40e4eddbbe9d","name":"action_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"a6eba0a2-eb78-4c1d-b73f-88a63a80c4c4","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"d07dec68-0654-4010-a277-9306b4dcb34c"},{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"2e9e052a-c3e1-4b33-9322-f60f9f303542"},{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"442c3501-903c-4686-98ef-68d460e02015"},{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"f850bcff-184c-4a6b-a745-8e54ea582b47"},{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5f7aca2e-2f7c-453f-a8fe-4086fe32d7aa"},{"kind":"app_task","name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"d5fc6584-3f46-4a22-812e-bd7b06c13ac9"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"d07dec68-0654-4010-a277-9306b4dcb34c"},"edge_type":"inherent","type":"","uuid":"a8e1365a-8c5f-401c-b19f-2f272b9c3fba","to_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"2e9e052a-c3e1-4b33-9322-f60f9f303542"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"2e9e052a-c3e1-4b33-9322-f60f9f303542"},"edge_type":"inherent","type":"","uuid":"b9e660b6-efc1-4e7e-98e0-5573e05cdc89","to_task_reference":{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"442c3501-903c-4686-98ef-68d460e02015"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"f850bcff-184c-4a6b-a745-8e54ea582b47"},"edge_type":"inherent","type":"","uuid":"c4ebad31-1ccb-40fd-a86a-7c1a70dc33ae","to_task_reference":{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5f7aca2e-2f7c-453f-a8fe-4086fe32d7aa"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"442c3501-903c-4686-98ef-68d460e02015"},"edge_type":"inherent","type":"","uuid":"af274967-73fb-4ea5-b0a2-c8fac9fe0fc6","to_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"f850bcff-184c-4a6b-a745-8e54ea582b47"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"5f7aca2e-2f7c-453f-a8fe-4086fe32d7aa"},"edge_type":"inherent","type":"","uuid":"a382713a-0661-44d0-8b38-42f5f87591fe","to_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"d5fc6584-3f46-4a22-812e-bd7b06c13ac9"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"d07dec68-0654-4010-a277-9306b4dcb34c","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"2e9e052a-c3e1-4b33-9322-f60f9f303542","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"fe42eb38_runbook","uuid":"1f4b2e17-4354-4c08-8bb6-74c8ba0ca573"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"442c3501-903c-4686-98ef-68d460e02015","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"52aa9058-c314-484e-ad98-b4cadc28e7ae"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"f850bcff-184c-4a6b-a745-8e54ea582b47","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"1e6143e5-0549-46ea-8ed9-afc20d7f89c9"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"5f7aca2e-2f7c-453f-a8fe-4086fe32d7aa","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"bd422cbf_runbook","uuid":"9c19d663-f9e3-20e7-e0a6-267f8768ee87"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__post_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"DELETE_DEPLOYMENT_ELEMENT","uuid":"d5fc6584-3f46-4a22-812e-bd7b06c13ac9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"bcb68540-7ee2-458e-90ab-1a05f9232a1d","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"a6eba0a2-eb78-4c1d-b73f-88a63a80c4c4"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"System action for deleting an application. Does not delete created VMs","message_list":[],"uuid":"243e3f05-87ba-4614-aec6-41a05de39dec","name":"action_soft_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Nutanix","uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"},"retries":"0","description":"","type":"DAG","uuid":"ba1be7a7-cfd6-46bc-a945-8067c02aaa56","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"4180ceed-a5b6-4565-8e89-44e0ecbad6a2"},{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"d2e3b3b4-b077-4d0b-80af-245371065c45"},{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"83028b76-9a8b-45d7-8089-d0ef1afd1305"},{"kind":"app_task","name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"9157e908-ea41-4971-9f94-f7c058572cfc"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"4180ceed-a5b6-4565-8e89-44e0ecbad6a2"},"edge_type":"inherent","type":"","uuid":"13bdbe46-1cf6-4e66-a56d-9d874f5f5f40","to_task_reference":{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"d2e3b3b4-b077-4d0b-80af-245371065c45"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"83028b76-9a8b-45d7-8089-d0ef1afd1305"},"edge_type":"inherent","type":"","uuid":"a619ae0e-0542-40e0-bf1c-b82353ad7be5","to_task_reference":{"kind":"app_task","name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760","uuid":"9157e908-ea41-4971-9f94-f7c058572cfc"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"d2e3b3b4-b077-4d0b-80af-245371065c45"},"edge_type":"inherent","type":"","uuid":"8ca2aa52-9533-4cfc-8133-c521533af625","to_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"83028b76-9a8b-45d7-8089-d0ef1afd1305"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"4180ceed-a5b6-4565-8e89-44e0ecbad6a2","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"c64c0489-8a38-40e3-ae8c-58e075f7e015"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"SOFT_DELETE_ELEMENT","uuid":"d2e3b3b4-b077-4d0b-80af-245371065c45","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_substrate","name":"PostgreSQL","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"83028b76-9a8b-45d7-8089-d0ef1afd1305","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"deployment_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4","uuid":"74700936-4913-4288-8f1a-78e30542f367"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__soft_delete_CRb_Substrate_a1b913ee_dbad_4d23_88ee_86bc78ea9eb4"},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"f6be2786_deployment","uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"},"retries":"0","description":"","type":"SOFT_DELETE_DEPLOYMENT_ELEMENT","uuid":"9157e908-ea41-4971-9f94-f7c058572cfc","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DE_Soft_Delete_55d915ec_e34e_4bd5_aa49_1f070f437760"}],"description":"","message_list":[],"uuid":"9cea44f4-0bef-4be5-8840-3822b5c1b55e","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9","uuid":"ba1be7a7-cfd6-46bc-a945-8067c02aaa56"},"name":"SYS_GEN__Runbook_Application_1aa800e6_3061_4105_b1f5_3bfcac5d4bc9"}},{"description":"","message_list":[],"uuid":"041e24b3-c90d-c9bb-2552-fd0719137fea","name":"Create SLA","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"54b5f8c6-087d-8020-84d2-ac0a261f339a","child_tasks_local_reference_list":[{"kind":"app_task","name":"Create SLA","uuid":"8ae27cfd-a8a9-3bf8-83c5-4c6a5d260463"}],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"2b1c9885_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"8ae27cfd-a8a9-3bf8-83c5-4c6a5d260463","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"name\": \"@@{SLANAME}@@\",\n  \"description\": \"@@{SLA_DESCRIPTION}@@\",\n  \"continuousRetention\": \"@@{CONTINUOUS_RETENTION}@@\",\n  \"dailyRetention\": \"@@{DAILY_RETENTION}@@\",\n  \"weeklyRetention\": \"@@{WEEKLY_RETENTION}@@\",\n  \"monthlyRetention\": \"@@{MONTHLY_RETENTION}@@\",\n  \"quarterlyRetention\": \"@@{QUARTERLY_RETENTION}@@\",\n  \"yearlyRetention\": \"@@{YEARLY_RETENTION}@@\",\n  \"systemSla\": \"true\"\n  \n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create SLA"}],"description":"","message_list":[],"uuid":"b4c300d9-9f66-c139-8b9b-c7b4faf3aec1","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"2e42814a-0ec6-4ed7-3ae0-110af3789d88","value":"SLA1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SLANAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"5594c301-4e14-afda-e26a-b4fdb25c3676","value":"Test SLA1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SLA_DESCRIPTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"f7a3ee14-2cda-2830-310b-a668be545fe2","value":"7","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"CONTINUOUS_RETENTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"56b61c88-e46e-3cd5-f4da-efe3b6cdef8d","value":"30","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DAILY_RETENTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"bf4f87f2-11ab-164f-b218-c6b1a99879bc","value":"8","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"WEEKLY_RETENTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"ab0e6a2a-af3c-2ae0-1f4d-1d32837df64a","value":"6","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"MONTHLY_RETENTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0705b85d-79c4-b709-f0ad-92fb29711ab1","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"QUARTERLY_RETENTION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"90c462d0-c0cb-3bf6-a10c-205159fe65b4","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"YEARLY_RETENTION"}],"main_task_local_reference":{"kind":"app_task","name":"2b1c9885_dag","uuid":"54b5f8c6-087d-8020-84d2-ac0a261f339a"},"name":"c8cd76ed_runbook"}},{"description":"","message_list":[],"uuid":"369f9e9f-5142-2caa-1a8d-ddf483cb9fa8","name":"Update Time Machine","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"7ba49280-1b45-1119-f3ee-08172bb25d15","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get TM ID","uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e"},{"kind":"app_task","name":"Get SLA ID","uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651"},{"kind":"app_task","name":"Update TM","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e"},"edge_type":"user_defined","type":"","uuid":"bc1cc3c4-8db5-af35-35d7-50a4f211a716","to_task_reference":{"kind":"app_task","name":"Update TM","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"}},{"from_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651"},"edge_type":"user_defined","type":"","uuid":"bcbedc6c-2323-9357-561a-445e74d3c543","to_task_reference":{"kind":"app_task","name":"Update TM","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"1e5ccf87_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLANAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get SLA ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/new\"\nresp_out = {}\n\n\npayload = \"\"\"\n{\n    \"name\":\"@@{NEW_TM_NAME}@@\",\n    \"description\":\"era_pg_db_tm\",\n    \"id\":\"@@{TM_ID}@@\",\n    \"slaId\":\"@@{SLA_ID}@@\",\n    \"schedule\":{\n        \"snapshotTimeOfDay\":{\n            \"hours\": @@{SCHEDULE_HOURS}@@,\n            \"minutes\": @@{SCHEDULE_MINUTES}@@,\n            \"seconds\": @@{SCHEDULE_SECONDS}@@\n        },\n        \"continuousSchedule\":{\n            \"enabled\":true,\n            \"logBackupInterval\": @@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@,\n            \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n        },\n        \"weeklySchedule\":{\n            \"enabled\":true,\n            \"dayOfWeek\":\"@@{DAY_OF_WEEK}@@\"\n        },\n        \"monthlySchedule\":{\n            \"enabled\":true,\n            \"dayOfMonth\":@@{DAY_OF_MONTH}@@\n        },\n        \"quartelySchedule\":{\n            \"enabled\":true,\n            \"startMonth\":\"@@{QUARTER_START_MONTH}@@\",\n            \"dayOfMonth\": @@{DAY_OF_MONTH}@@\n        },\n        \"yearlySchedule\":{\n            \"enabled\":false,\n            \"dayOfMonth\":31,\n            \"month\":\"DECEMBER\"\n        }\n    },\n    \"tags\":[]\n}\n\"\"\"\n\n# Update Time Machine\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, params=payload, headers=headers)\nresp_out = json.loads(resp.content)\nprint resp_out\n  \nif \"status_code\" in resp_out and  resp_out[\"status_code\"] != 200:\n  print \"Time machine update is failed for @@{TM_NAME}@@\"\n  exit(1)\n  \n\n  "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Update TM"}],"description":"","message_list":[],"uuid":"2ebe2c7d-12ab-6350-30a3-c7add96bbcc5","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","message_list":[],"uuid":"cc4b1cfd-7dd0-e052-00b3-fdea9a9c2799","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{"type":"PREDEFINED","choices":[]},"name":"TM_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"8f9cda1f-0105-c379-19a1-33937a44b849","value":"SLA1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SLANAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"7cf646ed-b4f0-d562-b83c-3261fc26869c","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_HOURS"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"e4e19306-53a7-f539-ef16-63e3d56073e8","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_MINUTES"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"4567df0f-4e44-e699-0485-29dd35e49d50","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_SECONDS"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"9489eb92-1041-38ee-5cdb-15268405bf8f","value":"40","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"LOG_CATCHUP_INTERVAL_IN_MINUTE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"08e10b5c-caf9-e139-cc02-ceb0daa33518","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SNAPSHOT_PER_DAY"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"3689cfb1-317b-8eba-5145-ccb9c74d3dee","value":"TUESDAY","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DAY_OF_WEEK"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0ad4a60b-4911-f891-6a5d-6acbe2fa0bbc","value":"26","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DAY_OF_MONTH"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"de758b5c-4021-d27c-1c5e-a14062f6eaf2","value":"FEBRUARY","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"QUARTER_START_MONTH"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"97ce49a9-548c-4cff-d6b7-5c64034a261e","value":"era_pg_db1_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"NEW_TM_NAME"}],"main_task_local_reference":{"kind":"app_task","name":"1e5ccf87_dag","uuid":"7ba49280-1b45-1119-f3ee-08172bb25d15"},"name":"e5ae1685_runbook"}},{"description":"","message_list":[],"uuid":"21e0f5ba-588e-be21-b922-5a540aadd1c8","name":"Manage Postgresql Service","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"f9fb22bc-bdc3-c33d-e113-9f57f8af47ce","child_tasks_local_reference_list":[{"kind":"app_task","name":"Postgresql Service","uuid":"78995629-50eb-cf3f-7cd2-9513fea4b5c9"}],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"ff7579d0_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"78995629-50eb-cf3f-7cd2-9513fea4b5c9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\nOPERATION=\"@@{OPERATION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\nsudo systemctl $OPERATION $SERVICE_NAME\nsleep 2;\nsudo systemctl status $SERVICE_NAME ","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Postgresql Service"}],"description":"","message_list":[],"uuid":"c528d3c9-2940-fb13-027c-9b39940b0c90","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"64af1b43-d972-ed35-9771-3046cdf3500b","value":"restart","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"OPERATION"}],"main_task_local_reference":{"kind":"app_task","name":"ff7579d0_dag","uuid":"f9fb22bc-bdc3-c33d-e113-9f57f8af47ce"},"name":"1bcaea31_runbook"}},{"description":"","message_list":[],"uuid":"63feda16-272b-d581-0250-734b3bd356b5","name":"Create Snapshot","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"a3f3a8db-af06-0496-e77c-2a6217da69c6","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get TM ID","uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284"},{"kind":"app_task","name":"Take Snapshots ","uuid":"a52ab74f-fd53-49c7-a000-febab9156cca"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284"},"edge_type":"user_defined","type":"","uuid":"3d9fb1cb-8632-58f7-687a-c771f0be5184","to_task_reference":{"kind":"app_task","name":"Take Snapshots ","uuid":"a52ab74f-fd53-49c7-a000-febab9156cca"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"0130bcb4_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"a52ab74f-fd53-49c7-a000-febab9156cca","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"actionHeader\": [\n    {\n      \"name\": \"snapshotName\",\n      \"value\": \"@@{SNAPSHOTNAME}@@\"\n    }\n  ] \n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/snapshots","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Take Snapshots "}],"description":"","message_list":[],"uuid":"af8b729a-db6a-5c05-e9fa-eca0ad3df263","state":"ACTIVE","variable_list":[{"regex":{"should_validate":false,"value":"^.*$"},"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","message_list":[],"uuid":"e28565af-f810-dc94-7911-bd50f85fab4c","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{"type":"PREDEFINED","choices":[]},"name":"TM_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"ea8486f6-65a8-9bcb-8212-2d90796f0f2a","value":"Test_SNAP_1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SNAPSHOTNAME"}],"main_task_local_reference":{"kind":"app_task","name":"0130bcb4_dag","uuid":"a3f3a8db-af06-0496-e77c-2a6217da69c6"},"name":"cbc09bc9_runbook"}},{"description":"","message_list":[],"uuid":"c3c9eb6c-a573-c2c3-83c5-f07ce1022d40","name":"Delete SLA","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"f9032724-fc4b-0670-4c62-ab8df23ec63f","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get SLA ID","uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f"},{"kind":"app_task","name":"Delete SLA","uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f"},"edge_type":"user_defined","type":"","uuid":"abb6aab7-7d65-fd06-d7b5-3d2abcffcdd6","to_task_reference":{"kind":"app_task","name":"Delete SLA","uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"3bced3bb_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLANAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get SLA ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/@@{SLA_ID}@@","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"DELETE"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Delete SLA"}],"description":"","message_list":[],"uuid":"d6a28cf0-6476-a01e-5fed-66d277609b7e","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":true,"description":"","data_type":"BASE","message_list":[],"uuid":"aa42f1ec-cf40-bd53-1400-f276615195c5","value":"TestSLA","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{"type":"PREDEFINED","choices":[]},"name":"SLANAME"}],"main_task_local_reference":{"kind":"app_task","name":"3bced3bb_dag","uuid":"f9032724-fc4b-0670-4c62-ab8df23ec63f"},"name":"a934e608_runbook"}},{"description":"","message_list":[],"uuid":"651651a2-08c2-0ec4-3443-5bd3f0413578","name":"Log Catchup","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"dadc880d-e379-acb6-1948-1f3d6c9fb315","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get TM ID","uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa"},{"kind":"app_task","name":"Do Log CatchUp","uuid":"ffb0202a-9577-eec0-3939-52cf5e243072"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa"},"edge_type":"user_defined","type":"","uuid":"358125b0-423f-9692-3ecd-9c5e26124934","to_task_reference":{"kind":"app_task","name":"Do Log CatchUp","uuid":"ffb0202a-9577-eec0-3939-52cf5e243072"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"cabe4447_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"ffb0202a-9577-eec0-3939-52cf5e243072","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"actionHeader\": [\n    {\n      \"name\": \"switch_log\",\n      \"value\": \"true\"\n    }\n  ] \n}\n","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/log-catchups","response_paths":{"operationId":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Do Log CatchUp"}],"description":"","message_list":[],"uuid":"b03d2818-4ab7-fe56-3838-8e6890aec197","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"3a9a62dd-5b99-49f2-e9a4-0acb4a4caaec","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"TM_NAME"}],"main_task_local_reference":{"kind":"app_task","name":"cabe4447_dag","uuid":"dadc880d-e379-acb6-1948-1f3d6c9fb315"},"name":"8c3933d2_runbook"}},{"description":"","message_list":[],"uuid":"a541171d-1669-e633-6635-39518a06e8b1","name":"Clone DB","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"fbfaf12d-5048-2cae-b351-3898eb653302","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get Network Profile ID","uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4"},{"kind":"app_task","name":"Get DB Parameter Profile ID","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},{"kind":"app_task","name":"Get TM ID","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},{"kind":"app_task","name":"Get Compute Profile ID","uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff"},{"kind":"app_task","name":"Get TM Capability","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"},{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get DB Parameter Profile ID","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},"edge_type":"user_defined","type":"","uuid":"686ae9a8-3272-b7a9-c387-c6a38c602f86","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},"edge_type":"user_defined","type":"","uuid":"68ffc5c7-2835-5347-c5f8-598cc90c42e7","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},"edge_type":"user_defined","type":"","uuid":"40871ac2-1bc0-be41-c69e-8e7e5854dcbd","to_task_reference":{"kind":"app_task","name":"Get TM Capability","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"}},{"from_task_reference":{"kind":"app_task","name":"Get TM Capability","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"},"edge_type":"user_defined","type":"","uuid":"fa4df40e-6e4d-d8e6-3d96-5edd4d478503","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","name":"Get Compute Profile ID","uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff"},"edge_type":"user_defined","type":"","uuid":"31cdcf77-c57a-b311-c4ae-7a790ad043bb","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","name":"Get Network Profile ID","uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4"},"edge_type":"user_defined","type":"","uuid":"83bc2bfb-c703-ecfd-7f8f-7bf49d7ec99d","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","name":"Get DB Parameter Profile ID","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},"edge_type":"user_defined","type":"","uuid":"cb613227-cd9b-8b4b-70e3-19341ea4a5f1","to_task_reference":{"kind":"app_task","name":"Do Clone DB","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"90a0579d_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Network&engine=postgres_database&name=@@{NETWORK_PROFILE}@@","response_paths":{"NETWORK_PROFILE_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Network Profile ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Database_Parameter&engine=postgres_database&name=@@{DB_PARAMS_PROFILE}@@","response_paths":{"DB_PARAMS_PROFILE_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get DB Parameter Profile ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Compute&engine=postgres_database&name=@@{COMPUTE_PROFILE}@@","response_paths":{"COMPUTE_PROFILE_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Compute Profile ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/capability","response_paths":{"SNAPSHOT_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM Capability"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"381681c5-2a38-725f-be49-e5e0d727274d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n  \"cloneName\": \"@@{CLONE_NAME}@@\",\n  \"cloneDescription\": \"\",\n  \"timeMachineId\": \"@@{TM_ID}@@\",\n  \"snapshotId\": null,\n  \"pitrTimestamp\": \"@@{PITR_TIME}@@\",\n  \"timeZone\": \"Asia\/Calcutta\",\n  \"latestSnapshot\": false,\n  \"newImplementation\": false,\n  \"tags\": [],\n  \"cloneInfo\": [\n    {\n      \"name\": \"vm_name\",\n      \"value\": \"@@{VM_NAME}@@\"\n    },\n    {\n      \"name\": \"working_dir\",\n      \"value\": \"\/tmp\"\n    },\n    {\n      \"name\": \"era_deploy_base\",\n      \"value\": \"\/opt\/era_base\"\n    },\n    {\n      \"name\": \"create_dbserver\",\n      \"value\": \"true\"\n    },\n    {\n      \"name\": \"compute_profile_id\",\n      \"value\": \"@@{COMPUTE_PROFILE_ID}@@\"\n    },\n    {\n      \"name\": \"network_profile_id\",\n      \"value\": \"@@{NETWORK_PROFILE_ID}@@\"\n    },\n    {\n      \"name\": \"client_public_key\",\n      \"value\": \"@@{CLIENT_PUB_KEY}@@\"\n    },\n    {\n      \"name\": \"db_password\",\n      \"value\": \"@@{DB_PASSWORD}@@\"\n    },\n    {\n      \"name\": \"db_parameter_profile_id\",\n      \"value\": \"@@{DB_PARAMS_PROFILE_ID}@@\"\n    }\n  ]\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/clones","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Do Clone DB"}],"description":"","message_list":[],"uuid":"78019a4c-eb44-db86-8faf-e4fce98521a7","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"44dc8d12-dd78-5739-f042-6282c8b081ef","value":"DEFAULT_OOB_COMPUTE","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"COMPUTE_PROFILE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"bcc97b43-7675-4e13-cb64-b9bb237d3f89","value":"DEFAULT_OOB_NETWORK","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"NETWORK_PROFILE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"3bc20aa4-7931-e0b4-1981-607ee33a9413","value":"DEFAULT_POSTGRES_PARAMS","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_PARAMS_PROFILE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"9f69036c-89c3-199f-72a6-7f44854bce07","value":"era_auto_snapshot","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SNAPSHOTNAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"fb2f58ea-b4a9-30a4-92fd-45ca8b4203b4","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"TM_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"fccdc6f7-4b10-3371-83e2-1ac39f214b46","value":"","label":"","state":"ACTIVE","attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"d41a8967-b197-434d-bccb-9364fb9cf33b"},"type":""},"editables":{"value":true},"is_hidden":false,"type":"SECRET","options":{},"name":"CLIENT_PUB_KEY"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"3baf2445-6c2b-8f43-7be7-5e13ba8b5b23","value":"","label":"","state":"ACTIVE","attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"cb158e59-0f39-4853-a2a3-4f398222e188"},"type":""},"editables":{"value":true},"is_hidden":false,"type":"SECRET","options":{},"name":"DB_PASSWORD"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"b9da6a49-7588-db93-9989-f59d502d5c65","value":"era_pg_db_clone","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"CLONE_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"e76575f6-8869-80ed-7b3f-234c3bebff00","value":"era_pg_db_clone_vm","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"VM_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"f4ded61e-df3d-f516-10b2-6a7a076d1d07","value":"2019-03-04 08:47:00","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PITR_TIME"}],"main_task_local_reference":{"kind":"app_task","name":"90a0579d_dag","uuid":"fbfaf12d-5048-2cae-b351-3898eb653302"},"name":"9e4e6017_runbook"}},{"description":"","message_list":[],"uuid":"579f3b63-f85f-d12d-ace1-c6bb4f69d2b7","name":"Pause Time Machine","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"67b48f8b-6d29-f105-ca58-00ab6cdd6e56","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get TM ID","uuid":"965a164e-187f-7812-45be-1b95c6022cde"},{"kind":"app_task","name":"Pause TM","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"},{"kind":"app_task","name":"Get TM Status","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"},{"kind":"app_task","name":"Verify TM Status","uuid":"aade2394-eddd-f1db-46d2-bc74c6421793"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Pause TM","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"},"edge_type":"user_defined","type":"","uuid":"35450be8-1584-7a96-6f1e-9015cfd25512","to_task_reference":{"kind":"app_task","name":"Get TM Status","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"}},{"from_task_reference":{"kind":"app_task","name":"Get TM Status","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"},"edge_type":"user_defined","type":"","uuid":"3bc5bfb6-558d-2ab1-98cd-0e5c6d970fa1","to_task_reference":{"kind":"app_task","name":"Verify TM Status","uuid":"aade2394-eddd-f1db-46d2-bc74c6421793"}},{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"965a164e-187f-7812-45be-1b95c6022cde"},"edge_type":"user_defined","type":"","uuid":"82154c6d-1e67-8b14-1acc-42812521c6ac","to_task_reference":{"kind":"app_task","name":"Pause TM","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"11de4cba_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"965a164e-187f-7812-45be-1b95c6022cde","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\ntm_id = '@@{TM_ID}@@'\n\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\nurl = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/%s\/status?status=paused\" % tm_id\nresp_out = {}\n\n# Get time machine id\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"Resp Code\", resp.status_code\n\nif resp.status_code != 200:\n  exit(1)\n"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Pause TM"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@","response_paths":{"TM_STATUS":"$.status"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM Status"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"aade2394-eddd-f1db-46d2-bc74c6421793","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\ntm_status = \"@@{TM_STATUS}@@\"\nexpected_status = \"PAUSED\"\n\nif tm_status != expected_status:\n  print \"Time Machine state(%s) is not in expected state(%s)\" % (tm_status, expected_status) \n  exit(1)\n  \nprint \"Time Machine state(%s) is in expected state(%s)\" % (tm_status, expected_status) "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Verify TM Status"}],"description":"","message_list":[],"uuid":"f9813a5e-3aa0-d399-86f6-0e05de598465","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0c0dac2b-e74f-f086-393b-66f7c2aaf614","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"TM_NAME"}],"main_task_local_reference":{"kind":"app_task","name":"11de4cba_dag","uuid":"67b48f8b-6d29-f105-ca58-00ab6cdd6e56"},"name":"a06e9d3e_runbook"}},{"description":"","message_list":[],"uuid":"7c6eb38d-3694-6da5-bd4f-94a4c459a51f","name":"Resume Time Machine","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"a85242fe-1ec2-5000-39bd-165027c63a31","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get TM ID","uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12"},{"kind":"app_task","name":"Resume TM","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"},{"kind":"app_task","name":"Get TM Status","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"},{"kind":"app_task","name":"Verify TM Status","uuid":"4c8163fc-5e8d-05be-484c-69453b24a920"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get TM ID","uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12"},"edge_type":"user_defined","type":"","uuid":"40bbb424-e39c-c344-582c-0ba20d6ca37c","to_task_reference":{"kind":"app_task","name":"Resume TM","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"}},{"from_task_reference":{"kind":"app_task","name":"Resume TM","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"},"edge_type":"user_defined","type":"","uuid":"e38f6d77-6929-e36b-a9ab-0774e0cee82c","to_task_reference":{"kind":"app_task","name":"Get TM Status","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"}},{"from_task_reference":{"kind":"app_task","name":"Get TM Status","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"},"edge_type":"user_defined","type":"","uuid":"fd88e3c1-e408-fa94-f063-ffac774e1bb0","to_task_reference":{"kind":"app_task","name":"Verify TM Status","uuid":"4c8163fc-5e8d-05be-484c-69453b24a920"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"d8c7e7ce_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\ntm_id = '@@{TM_ID}@@'\n\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\nurl = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/%s\/status?status=ready\" % tm_id\nresp_out = {}\n\n# Get time machine id\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"Resp Code\", resp.status_code\n\nif resp.status_code != 200:\n  exit(1)\n"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Resume TM"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@","response_paths":{"TM_STATUS":"$.status"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get TM Status"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"4c8163fc-5e8d-05be-484c-69453b24a920","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\ntm_status = \"@@{TM_STATUS}@@\"\nexpected_status = \"READY\"\n\nif tm_status != expected_status:\n  print \"Time Machine state(%s) is not in expected state(%s)\" % (tm_status, expected_status) \n  exit(1)\n  \nprint \"Time Machine state(%s) is in expected state(%s)\" % (tm_status, expected_status) "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Verify TM Status"}],"description":"","message_list":[],"uuid":"6f4397cc-eb7c-413f-9278-88136002f443","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"ded581c2-87b8-3562-b228-b7abb24e0073","value":"era_pg_db_TM","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"TM_NAME"}],"main_task_local_reference":{"kind":"app_task","name":"d8c7e7ce_dag","uuid":"a85242fe-1ec2-5000-39bd-165027c63a31"},"name":"8b3015a4_runbook"}},{"description":"","message_list":[],"uuid":"5e24e260-d31c-4e23-5667-d4478a9b9a5e","name":"Unregister Database","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"32c92916-a753-2f1f-0b43-37bea51a0cde","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get DB ID","uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56"},{"kind":"app_task","name":"Unregister DB","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"},{"kind":"app_task","name":"Monitor Unregister DB Operation","uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get DB ID","uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56"},"edge_type":"user_defined","type":"","uuid":"9130e966-7185-eefd-992e-aca7ae8600c4","to_task_reference":{"kind":"app_task","name":"Unregister DB","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"}},{"from_task_reference":{"kind":"app_task","name":"Unregister DB","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"},"edge_type":"user_defined","type":"","uuid":"9815487a-13d0-2b7a-bfd1-2fed64e01fa3","to_task_reference":{"kind":"app_task","name":"Monitor Unregister DB Operation","uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"c1aab0cf_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases\/name\/@@{DBNAME}@@","response_paths":{"DB_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get DB ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases\/@@{DB_ID}@@?storage-cleanup=true&tm-cleanup=true","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"DELETE"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Unregister DB"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Unregister DB Operation"}],"description":"","message_list":[],"uuid":"bfe6670c-c1ae-2d47-b89c-5e0e9aebe6a5","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"556f971d-4b07-d667-e677-63f56fd78bd3","value":"era_pg_db","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DBNAME"}],"main_task_local_reference":{"kind":"app_task","name":"c1aab0cf_dag","uuid":"32c92916-a753-2f1f-0b43-37bea51a0cde"},"name":"608d29d3_runbook"}},{"description":"","message_list":[],"uuid":"7db15460-a773-d386-76ae-ed40fb506478","name":"Unregister Database  Server","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"d4a22e7a-82e8-56f0-136e-55ce51b35c11","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get DB Server ID","uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580"},{"kind":"app_task","name":"Unregister DB Server","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"},{"kind":"app_task","name":"Monitor Unregister DB Server Operation","uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get DB Server ID","uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580"},"edge_type":"user_defined","type":"","uuid":"9bcc66a1-6d0f-6e1e-4fd8-06aa04022038","to_task_reference":{"kind":"app_task","name":"Unregister DB Server","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"}},{"from_task_reference":{"kind":"app_task","name":"Unregister DB Server","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"},"edge_type":"user_defined","type":"","uuid":"b93078c6-4ae2-b9ee-db92-55aa6721c3b4","to_task_reference":{"kind":"app_task","name":"Monitor Unregister DB Server Operation","uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"aa329bb8_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/name\/@@{DB_SERVER_NAME}@@","response_paths":{"DB_SERVER_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get DB Server ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/@@{DB_SERVER_ID}@@?remove=true","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"DELETE"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Unregister DB Server"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Unregister DB Server Operation"}],"description":"","message_list":[],"uuid":"5e8eeb20-8e58-49f4-c670-f17a45e5b594","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"2d967732-1fc7-d0b8-7129-3321224d010f","value":"lin-0-db-server","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_SERVER_NAME"}],"main_task_local_reference":{"kind":"app_task","name":"aa329bb8_dag","uuid":"d4a22e7a-82e8-56f0-136e-55ce51b35c11"},"name":"3af1d5ca_runbook"}},{"description":"","message_list":[],"uuid":"b1af722a-9b58-419e-be3e-468d8198ef09","name":"Create Profile","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"9298a1dc-5c79-599e-e237-a3a3df555e0f","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get DB Server ID","uuid":"afa36105-29a1-26ec-7688-0271469f41ae"},{"kind":"app_task","name":"Create Profile","uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get DB Server ID","uuid":"afa36105-29a1-26ec-7688-0271469f41ae"},"edge_type":"user_defined","type":"","uuid":"05e60b8f-c648-cebd-906f-7a4c5f2301ab","to_task_reference":{"kind":"app_task","name":"Create Profile","uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"bf3021fc_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"afa36105-29a1-26ec-7688-0271469f41ae","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/name\/@@{DB_SERVER_NAME}@@","response_paths":{"SOURCE_DBSERVER_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get DB Server ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n\t\"engineType\":\"@@{DB_ENGINE}@@\",\n    \"type\":\"@@{PROFILE_TYPE}@@\",\n    \"dbVersion\":\"ALL\",\n\t\"properties\":[\n\t\t{\n        \t\"name\":\"SOURCE_DBSERVER_ID\",\n\t\t\t\"value\":\"@@{SOURCE_DBSERVER_ID}@@\",\n\t\t\t\"description\":\"ID of the database server that should be used as a reference to create the software profile\"\n\t\t}\n     ],\n\t\"name\":\"@@{PROFILE_NAME}@@\",\n\t\"description\":\"@@{PROFILE_DESCRIPTION}@@\"\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/profiles","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create Profile"}],"description":"","message_list":[],"uuid":"fbf5a324-7830-d4d7-c921-f52139feb818","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"67b3b634-4266-7c64-e7b0-44a484290ee6","value":"lin-0-190228-223012","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_SERVER_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"b94c09ce-6fa0-3785-f332-5760675263b2","value":"postgres_database","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_ENGINE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"df4eb2a7-077c-c202-0440-ccd9cb749495","value":"Software","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PROFILE_TYPE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"88a0fd9b-1dd0-a8a8-c037-bb89f1d37c41","value":"TEST_PROFILE","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PROFILE_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"de5c335c-371d-fe18-19f0-bb663d1a0161","value":"Sample test profile","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PROFILE_DESCRIPTION"}],"main_task_local_reference":{"kind":"app_task","name":"bf3021fc_dag","uuid":"9298a1dc-5c79-599e-e237-a3a3df555e0f"},"name":"a74dcd1e_runbook"}},{"description":"","message_list":[],"uuid":"0f4e3512-64d0-af3e-3b74-863e456a0b13","name":"Delete Profile","state":"ACTIVE","critical":false,"attrs":{},"type":"user","runbook":{"task_definition_list":[{"retries":"0","description":"","type":"DAG","uuid":"a844e0c9-4de1-0f8e-67c7-205366b53f47","child_tasks_local_reference_list":[{"kind":"app_task","name":"Get Profile ID","uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70"},{"kind":"app_task","name":"Delete Profile","uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Get Profile ID","uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70"},"edge_type":"user_defined","type":"","uuid":"10516184-b4b7-4b13-4ff7-a117f7a3f9d1","to_task_reference":{"kind":"app_task","name":"Delete Profile","uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"ca61e0c0_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=@@{PROFILE_TYPE}@@&engine=@@{DB_ENGINE}@@&name=@@{PROFILE_NAME}@@","response_paths":{"PROFILE_ID":"$.id"},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Profile ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/profiles\/@@{PROFILE_ID}@@","response_paths":{},"retry_interval":1,"headers":[],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"DELETE"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Delete Profile"}],"description":"","message_list":[],"uuid":"aa6d3c17-0eb7-ba36-b252-ffaf524659c2","state":"ACTIVE","variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"f997a53c-b873-4478-1255-f27ccc1e43f4","value":"PG_Profile","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PROFILE_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"d46eb8d1-e4f1-edc1-a38d-25ead3192357","value":"Software","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PROFILE_TYPE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"35822173-51d5-4a15-b64e-7dce863d2cc5","value":"postgres_database","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_ENGINE"}],"main_task_local_reference":{"kind":"app_task","name":"ca61e0c0_dag","uuid":"a844e0c9-4de1-0f8e-67c7-205366b53f47"},"name":"309b14fd_runbook"}}],"message_list":[],"uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9","state":"ACTIVE","dependency_list":[],"variable_list":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"519f4e76-cf05-4714-8b43-6a9bfde724fd","value":"era_pg_db","label":"","state":"ACTIVE","attrs":{},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"592675ee-599e-488d-95a2-4e370fc7b7f3","value":"","label":"","state":"ACTIVE","attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"21e68392-3be6-40f5-b9b3-ced3f0ea6af9"},"type":""},"editables":{"value":true},"is_hidden":false,"type":"SECRET","options":{},"name":"DB_PASSWORD"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"e1845647-e8de-454c-a29d-2a622528d60d","value":"postgres","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_USER"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"94bbfdd0-96f5-4e41-a046-6a2fe71c50de","value":"10.46.35.90","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"ERA_IP"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"391729fc-985d-4b56-a7cc-3ebb05217fe7","value":"BRONZE","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SLA_NAME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"7a9a6b0f-d7a1-9371-6c88-01e3d78791b9","value":"\/usr\/pgsql-","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"PG_SOFTWARE_HOME"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"9fe243cc-91d4-ce80-be91-6aecdde63016","value":"9.6","label":"","state":"ACTIVE","attrs":{"type":"LOCAL"},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{"type":"PREDEFINED","choices":["9.6","10.4"]},"name":"DB_VERSION"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"b4cafd8b-c7df-5a76-2d03-5b50ee6fd90f","value":"5432","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DB_PORT"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"b9952629-7fd0-0257-f750-0cbeb3493d31","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SNAPSHOT_PER_DAY"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"a3392a50-9a37-c56e-8616-b4b50ce88276","value":"30","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"LOG_CATCHUP_INTERVAL_IN_MINUTE"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"b23f3505-05dd-ae5c-d4fa-cbfab40fc1c7","value":"MONDAY","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DAY_OF_WEEK"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"0cf89336-35df-e632-e9b4-16645278cadc","value":"25","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"DAY_OF_MONTH"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"f9cfbada-f89b-3d9a-06c6-bbe41ebccc21","value":"FEBRUARY","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"QUARTER_START_MONTH"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"c7cc0a4d-0f7e-52ff-e69a-3ff6378d7901","value":"1","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_HOURS"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"f7f37756-8747-c111-2b6f-e22d1e082316","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_MINUTES"},{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"dff97fef-eb42-8a22-1ddb-5de5b2441917","value":"0","label":"","state":"ACTIVE","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"type":"LOCAL","options":{},"name":"SCHEDULE_SECONDS"}],"name":"Nutanix"}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"era_web_cred","uuid":"6f127226-e987-443c-ac4c-daa9796b9af8"},"package_definition_list":[{"description":"","action_list":[{"description":"System action for installing an application","message_list":[],"uuid":"45dd79da-67f5-4d38-a874-6df8d9a4eb9a","name":"action_install","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"e06b75fa-c5bb-429f-9e69-d6ed0d809e26","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Install_Crb_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"be8ced6e-5bd0-4a32-a9f4-589a7b747923"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CUSTOM_PACKAGE_INSTALL","uuid":"be8ced6e-5bd0-4a32-a9f4-589a7b747923","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},"edge_type":"user_defined","type":"","uuid":"56b15a2e-857f-8b7c-5c54-361845d0aa9f","to_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"}},{"from_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},"edge_type":"user_defined","type":"","uuid":"523547e8-36f0-a840-5d60-772cd46baead","to_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"}},{"from_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},"edge_type":"user_defined","type":"","uuid":"7e4989fd-19da-1dd0-ed1c-9d7a1fb256ba","to_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"}},{"from_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},"edge_type":"user_defined","type":"","uuid":"68b15b8f-c3ec-6bed-c7f6-55339fa828ea","to_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"}},{"from_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},"edge_type":"user_defined","type":"","uuid":"701afd40-3386-42d2-7c23-29e10c83745a","to_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"}},{"from_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},"edge_type":"user_defined","type":"","uuid":"ed214671-6b3e-e9b3-f016-aa9569df35ed","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}},{"from_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},"edge_type":"user_defined","type":"","uuid":"c9987dd9-bd3c-12e2-eac4-fabccc53bd41","to_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"}},{"from_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},"edge_type":"user_defined","type":"","uuid":"a6a75362-5fe1-7bd8-68f8-94b6765dbd40","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"}},{"from_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},"edge_type":"user_defined","type":"","uuid":"89988f4e-2a4c-4f20-5c6e-48d1d8841d8e","to_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"}},{"from_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},"edge_type":"user_defined","type":"","uuid":"4cf60df5-81c6-f85e-2373-c35e9bc6c5f2","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}},{"from_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},"edge_type":"user_defined","type":"","uuid":"b92c3b3d-03ff-9380-bd96-62626569bfd3","to_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"}},{"from_task_reference":{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},"edge_type":"user_defined","type":"","uuid":"abc143d3-83b8-bf9e-25cb-1699dab49062","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"58ca4a03_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo yum -y upgrade\nsudo curl -O http:\/\/dl.fedoraproject.org\/pub\/epel\/7\/x86_64\/e\/epel-release-7-10.noarch.rpm\nsudo rpm --import https:\/\/www.elrepo.org\/RPM-GPG-KEY-elrepo.org\nsudo rpm -Uvh http:\/\/www.elrepo.org\/elrepo-release-7.0-3.el7.elrepo.noarch.rpm \nsudo rpm -ihv epel-release-7-10.noarch.rpm \n\nsudo yum update -y\nsudo yum -y install htop wget iotop xfs* bc unzip lvm2*\n\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/sysconfig\/selinux\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/selinux\/config\nsudo setenforce 0\n\necho \"System packages are installed\"\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install System Packages"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"SET_VARIABLE","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/auth\/validate?token=true&expire=15\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"TOKEN={0}\".format(json.loads(resp.content)['token'])","eval_variables":["TOKEN"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Token"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n##############\n#\n# LVM setup script for PostgreSQL . 4 disks for DATA and 2 for logs\n# Data disks are 60GB | Log disks are 20GB \n#\n#############\n\n\n#PGSQL data\nsudo pvcreate \/dev\/sdb \/dev\/sdc \/dev\/sdd \/dev\/sde\nsudo vgcreate pgDataVG \/dev\/sdb \/dev\/sdd \/dev\/sdc \/dev\/sde\nsudo lvcreate -l 100%FREE -i4 -I1M -n pgDataLV pgDataVG          ## Use 1MB to avoid IO amplification \n#lvcreate -l 100%FREE -i4 -I4M -n pgDataLV pgDataVG\n\n\n#PGSQL logs\nsudo pvcreate \/dev\/sdf \/dev\/sdg \nsudo vgcreate pgLogVG \/dev\/sdf \/dev\/sdg\nsudo lvcreate -l 100%FREE -i2 -I1M -n pgLogLV pgLogVG            ## Use 1MB to avoid IO amplification\n#lvcreate -l 100%FREE -i2 -I4M -n pgLogLV pgLogVG\n\n\n#Disable LVM read ahead\nsudo lvchange -r 0 \/dev\/pgDataVG\/pgDataLV\nsudo lvchange -r 0 \/dev\/pgLogVG\/pgLogLV\n\n\n#Format LVMs with ext4 and use nodiscard to make sure format time is fast on Nutanix due to SCSI unmap\nsudo mkfs.ext4 -E nodiscard \/dev\/pgDataVG\/pgDataLV\nsudo mkfs.ext4 -E nodiscard \/dev\/pgLogVG\/pgLogLV\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create Disk Setup"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.5\/redhat\/rhel-7-x86_64\/pgdg-centos95-9.5-3.noarch.rpm\n  sudo yum -y install pgdg-centos95-9.5-3.noarch.rpm\n\n  # Install PostgreSQL 9.5\n  sudo yum -y install postgresql95 postgresql95-contrib postgresql95-server postgresql95-plpython\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.6\/redhat\/rhel-7-x86_64\/pgdg-centos96-9.6-3.noarch.rpm\n  sudo yum -y install pgdg-centos96-9.6-3.noarch.rpm\n\n  # Install PostgreSQL 9.6\n  sudo yum -y install postgresql96 postgresql96-contrib postgresql96-server postgresql96-plpython\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/10\/redhat\/rhel-7-x86_64\/pgdg-centos10-10-2.noarch.rpm\n  sudo yum -y install pgdg-centos10-10-2.noarch.rpm\n\n  # Install PostgreSQL 10\n  sudo yum -y install postgresql10 postgresql10-contrib postgresql10-server postgresql10-plpython  \n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.5\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.5\/bin\/postgresql95-setup\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.6\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.6\/bin\/postgresql96-setup\"\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/10.2\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-10.2\/bin\/postgresql10-setup\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n#run initdb\nsudo $PG_SETUP_CMD initdb\n\n#start and stop postgresql to make sure DB creates the required directories\nsudo systemctl start $SERVICE_NAME\nsudo systemctl stop $SERVICE_NAME\n\n##copy the created postgres directory to a temp directory\nsudo mkdir \/tmp\/pgsql\n\nsudo mv $PG_DATA_HOME \/tmp\/pgsql\n\n#Create directory , fix permissions and Mount LVM\nsudo mkdir $PG_DATA_HOME\/\nsudo mount -o noatime,barrier=0 \/dev\/pgDataVG\/pgDataLV $PG_DATA_HOME\/ \n\nsudo mkdir $PG_DATA_HOME\/pg_xlog\nsudo mount -o noatime,barrier=0 \/dev\/pgLogVG\/pgLogLV $PG_DATA_HOME\/pg_xlog\n\nsudo chown -R postgres:postgres $PG_DATA_HOME\/\n\n#move the xlog to the new LVM\nsudo find \/tmp\/pgsql\/data\/pg_xlog -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/pg_xlog\/ {} +\n\n#remove pg_xlog from temp dir to avoid being copied again\nsudo rm -rf \/tmp\/pgsql\/data\/pg_xlog\n\n#move the pgsql directory to the LVM\nsudo find \/tmp\/pgsql\/data -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/ {} +\n\nsudo chmod -R 0700 $PG_DATA_HOME\n\n#enable service on boot\nsudo systemctl enable $SERVICE_NAME\n\n#add mount points to \/etc\/fstab\necho \"\/dev\/mapper\/pgDataVG-pgDataLV $PG_DATA_HOME ext4 rw,seclabel,noatime,nobarrier,stripe=4096,data=ordered 0 0\" | sudo tee -a \/etc\/fstab\necho \"\/dev\/mapper\/pgLogVG-pgLogLV $PG_DATA_HOME\/pg_xlog ext4 rw,seclabel,noatime,nobarrier,stripe=2048,data=ordered 0 0\" | sudo tee -a  \/etc\/fstab\n\n\nsudo systemctl status $SERVICE_NAME\nsudo systemctl restart $SERVICE_NAME\nsudo systemctl status $SERVICE_NAME\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Setup Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"33fab652-fa53-6acb-52a7-4b692147976d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_USER=\"@@{DB_USER}@@\"\nDB_NAME=\"@@{DB_NAME}@@\"\nDB_PASSWORD=\"@@{DB_PASSWORD}@@\"\n\n#sudo -i -u postgres sh -c \"createuser -d -E -R -S ${DB_USER}\";\nsudo -i -u postgres sh -c \"createdb -O ${DB_USER} -E UTF-8 -T template0 ${DB_NAME}\";\nsudo -i -u postgres psql -c \"ALTER USER postgres PASSWORD '${DB_PASSWORD}' ; \"\n#sudo -i -u postgres psql -c \"ALTER USER ${DB_USER} PASSWORD '${DB_PASSWORD}' ; \"\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create DB and User"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\necho \"local   all             postgres                                     trust\nhost    all             postgres             ::1\/128                 md5\nhost    all             postgres              127.0.0.1\/32           md5\" | sudo tee \/var\/lib\/pgsql\/9.6\/data\/pg_hba.conf\necho \"listen_addresses = '*'\" | sudo tee -a \/var\/lib\/pgsql\/9.6\/data\/postgresql.conf \nsleep 2;\n\nsudo systemctl restart postgresql-9.6\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Configure Era Access"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/clusters","response_paths":{"CLUSTER_ID":"$[0].id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"608b3a71-32a9-5653-c535-193b9cf734d0","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Cluster ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""},{"status":"FAILURE","code":422,"type":""}],"request_body":"{\n    \"status\": \"8\",\n    \"timeMachineId\": null,\n    \"forcedInstall\": true,\n    \"ownerId\": \"1\",\n    \"type\": \"register_host\",\n    \"actionArguments\": [],\n    \"vmInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"application_version\",\n        \"value\": \"@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }],\n    \"actionHeader\": [{\n        \"name\": \"cloudId\",\n        \"value\": \"@@{CLUSTER_ID}@@\"\n    }, {\n        \"name\": \"cloudName\",\n        \"value\": null\n    }, {\n        \"name\": \"host_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_name\",\n        \"value\": \"\"\n    }, {\n        \"name\": \"host_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"host_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }]\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"03aeafdc-017e-8466-ccde-72a86a90b411","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register DB Server"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"830ebb80-f852-fc97-1570-668e266cca32","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Servers Operation"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"264bebed-214b-d30c-5318-6593a4f889f9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLA_NAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"5fd2c982-787b-a190-0e53-436549ee4ce9","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get SLA ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"abeb71ba-254f-9782-2525-edc253625d5e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n    \"vmAdd\": true,\n    \"applicationInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"db_user\",\n        \"value\": \"@@{DB_USER}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"switch_log\",\n        \"value\": true\n    }, {\n        \"name\": \"allow_multiple_databases\",\n        \"value\": true\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"create_era_drive\",\n        \"value\": true\n    }, {\n        \"name\": \"vm_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"vm_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"database_name\",\n        \"value\": \"@@{DB_NAME}@@\"\n    }, {\n        \"name\": \"db_password\",\n        \"value\": \"@@{DB_PASSWORD}@@\"\n    }],\n    \"forcedInstall\": true,\n    \"clusterId\": \"@@{CLUSTER_ID}@@\",\n    \"tags\": [],\n    \"timeMachineInfo\": {\n        \"name\": \"@@{DB_NAME}@@_TM\",\n        \"description\": \"\",\n        \"slaId\": \"@@{SLA_ID}@@\",\n        \"schedule\": {\n            \"snapshotTimeOfDay\": {\n                \"hours\": @@{SCHEDULE_HOURS}@@,\n                \"minutes\": @@{SCHEDULE_MINUTES}@@,\n                \"seconds\": @@{SCHEDULE_SECONDS}@@\n            },\n            \"continuousSchedule\": {\n                \"enabled\": true,\n                \"logBackupInterval\": \"@@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@\",\n                \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n            },\n            \"weeklySchedule\": {\n                \"enabled\": true,\n                \"dayOfWeek\": \"@@{DAY_OF_WEEK}@@\"\n            },\n            \"monthlySchedule\": {\n                \"enabled\": true,\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"quartelySchedule\": {\n                \"enabled\": true,\n                \"startMonth\": \"@@{QUARTER_START_MONTH}@@\",\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"yearlySchedule\": {\n                \"enabled\": false,\n                \"dayOfMonth\": 31,\n                \"month\": \"DECEMBER\"\n            }\n        },\n        \"tags\": [],\n        \"autoTuneLogDrive\": true\n    },\n    \"applicationSlaName\": \"@@{SLA_NAME}@@\",\n    \"applicationType\": \"postgres_database\",\n    \"autoTuneStagingDrive\": true,\n    \"eraBaseDirectory\": \"\/opt\/era_base\",\n    \"applicationHost\": \"@@{address}@@\",\n    \"vmIp\": \"@@{address}@@\",\n    \"vmUsername\": \"@@{db_server_cred.username}@@\",\n    \"vmSSHPrivateKey\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\",\n    \"applicationName\": \"@@{DB_NAME}@@\",\n    \"vmDescription\": \"@@{DB_NAME}@@\"\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"8430aab9-9bdb-e6c9-ca61-70f59184f759","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register Database"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"db4594dd-072b-205e-a085-f1fb145fe627","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Operation"}],"description":"","message_list":[],"uuid":"2c8ef6b0-d9ab-46cc-884e-84eb527a07d0","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98"},"name":"8b1f1a7b_runbook"},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"ee8bedbe_dag"}],"description":"","message_list":[],"uuid":"af16f04e-9e2e-42b7-ab1d-1d41d0700084","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9"},"name":"faacff5d_runbook"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Install_Crb_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}],"description":"","message_list":[],"uuid":"24e07ac7-7136-483f-8968-e08f54a48741","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"e06b75fa-c5bb-429f-9e69-d6ed0d809e26"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for creating an application","message_list":[],"uuid":"4bcfacb1-1773-457a-88f1-ba33401ef43f","name":"action_create","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"cdb05cd9-5d14-45d6-8007-c34f506b8583","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"1d9cd9f5-ce8d-4c63-acb3-e51459d09187"},{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"3ebdb699-21c7-4d04-90e6-7e04abc8a183"},{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"24770bda-8d79-41bd-ab49-400e7b15210c"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"3ebdb699-21c7-4d04-90e6-7e04abc8a183"},"edge_type":"inherent","type":"","uuid":"ab853291-13a5-4369-b07e-2f4c804ef804","to_task_reference":{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"24770bda-8d79-41bd-ab49-400e7b15210c"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"1d9cd9f5-ce8d-4c63-acb3-e51459d09187"},"edge_type":"inherent","type":"","uuid":"6cb55792-bed1-4f77-b684-23e1d5894371","to_task_reference":{"kind":"app_task","name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"3ebdb699-21c7-4d04-90e6-7e04abc8a183"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"1d9cd9f5-ce8d-4c63-acb3-e51459d09187","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"24e07ac7-7136-483f-8968-e08f54a48741"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__install_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"3ebdb699-21c7-4d04-90e6-7e04abc8a183","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"01945104_runbook","uuid":"b8b80915-c631-4a78-ba59-97657ee6f8fc"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__create_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"24770bda-8d79-41bd-ab49-400e7b15210c","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"8b5807dc-4634-4d16-aadb-badd306ba35d","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"cdb05cd9-5d14-45d6-8007-c34f506b8583"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for uninstalling an application","message_list":[],"uuid":"88827cfa-9930-40d7-a155-c53799610077","name":"action_uninstall","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"6b517fc0-d034-458b-ac15-81362bb7445c","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__Uninstall_Crb_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"3299be43-cfe3-4f47-8102-fe47b6f33acb"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CUSTOM_PACKAGE_UNINSTALL","uuid":"3299be43-cfe3-4f47-8102-fe47b6f33acb","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},"edge_type":"user_defined","type":"","uuid":"56b15a2e-857f-8b7c-5c54-361845d0aa9f","to_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"}},{"from_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},"edge_type":"user_defined","type":"","uuid":"523547e8-36f0-a840-5d60-772cd46baead","to_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"}},{"from_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},"edge_type":"user_defined","type":"","uuid":"7e4989fd-19da-1dd0-ed1c-9d7a1fb256ba","to_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"}},{"from_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},"edge_type":"user_defined","type":"","uuid":"68b15b8f-c3ec-6bed-c7f6-55339fa828ea","to_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"}},{"from_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},"edge_type":"user_defined","type":"","uuid":"701afd40-3386-42d2-7c23-29e10c83745a","to_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"}},{"from_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},"edge_type":"user_defined","type":"","uuid":"ed214671-6b3e-e9b3-f016-aa9569df35ed","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}},{"from_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},"edge_type":"user_defined","type":"","uuid":"c9987dd9-bd3c-12e2-eac4-fabccc53bd41","to_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"}},{"from_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},"edge_type":"user_defined","type":"","uuid":"a6a75362-5fe1-7bd8-68f8-94b6765dbd40","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"}},{"from_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},"edge_type":"user_defined","type":"","uuid":"89988f4e-2a4c-4f20-5c6e-48d1d8841d8e","to_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"}},{"from_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},"edge_type":"user_defined","type":"","uuid":"4cf60df5-81c6-f85e-2373-c35e9bc6c5f2","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}},{"from_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},"edge_type":"user_defined","type":"","uuid":"b92c3b3d-03ff-9380-bd96-62626569bfd3","to_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"}},{"from_task_reference":{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},"edge_type":"user_defined","type":"","uuid":"abc143d3-83b8-bf9e-25cb-1699dab49062","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"58ca4a03_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo yum -y upgrade\nsudo curl -O http:\/\/dl.fedoraproject.org\/pub\/epel\/7\/x86_64\/e\/epel-release-7-10.noarch.rpm\nsudo rpm --import https:\/\/www.elrepo.org\/RPM-GPG-KEY-elrepo.org\nsudo rpm -Uvh http:\/\/www.elrepo.org\/elrepo-release-7.0-3.el7.elrepo.noarch.rpm \nsudo rpm -ihv epel-release-7-10.noarch.rpm \n\nsudo yum update -y\nsudo yum -y install htop wget iotop xfs* bc unzip lvm2*\n\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/sysconfig\/selinux\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/selinux\/config\nsudo setenforce 0\n\necho \"System packages are installed\"\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install System Packages"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"SET_VARIABLE","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/auth\/validate?token=true&expire=15\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"TOKEN={0}\".format(json.loads(resp.content)['token'])","eval_variables":["TOKEN"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Token"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n##############\n#\n# LVM setup script for PostgreSQL . 4 disks for DATA and 2 for logs\n# Data disks are 60GB | Log disks are 20GB \n#\n#############\n\n\n#PGSQL data\nsudo pvcreate \/dev\/sdb \/dev\/sdc \/dev\/sdd \/dev\/sde\nsudo vgcreate pgDataVG \/dev\/sdb \/dev\/sdd \/dev\/sdc \/dev\/sde\nsudo lvcreate -l 100%FREE -i4 -I1M -n pgDataLV pgDataVG          ## Use 1MB to avoid IO amplification \n#lvcreate -l 100%FREE -i4 -I4M -n pgDataLV pgDataVG\n\n\n#PGSQL logs\nsudo pvcreate \/dev\/sdf \/dev\/sdg \nsudo vgcreate pgLogVG \/dev\/sdf \/dev\/sdg\nsudo lvcreate -l 100%FREE -i2 -I1M -n pgLogLV pgLogVG            ## Use 1MB to avoid IO amplification\n#lvcreate -l 100%FREE -i2 -I4M -n pgLogLV pgLogVG\n\n\n#Disable LVM read ahead\nsudo lvchange -r 0 \/dev\/pgDataVG\/pgDataLV\nsudo lvchange -r 0 \/dev\/pgLogVG\/pgLogLV\n\n\n#Format LVMs with ext4 and use nodiscard to make sure format time is fast on Nutanix due to SCSI unmap\nsudo mkfs.ext4 -E nodiscard \/dev\/pgDataVG\/pgDataLV\nsudo mkfs.ext4 -E nodiscard \/dev\/pgLogVG\/pgLogLV\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create Disk Setup"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.5\/redhat\/rhel-7-x86_64\/pgdg-centos95-9.5-3.noarch.rpm\n  sudo yum -y install pgdg-centos95-9.5-3.noarch.rpm\n\n  # Install PostgreSQL 9.5\n  sudo yum -y install postgresql95 postgresql95-contrib postgresql95-server postgresql95-plpython\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.6\/redhat\/rhel-7-x86_64\/pgdg-centos96-9.6-3.noarch.rpm\n  sudo yum -y install pgdg-centos96-9.6-3.noarch.rpm\n\n  # Install PostgreSQL 9.6\n  sudo yum -y install postgresql96 postgresql96-contrib postgresql96-server postgresql96-plpython\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/10\/redhat\/rhel-7-x86_64\/pgdg-centos10-10-2.noarch.rpm\n  sudo yum -y install pgdg-centos10-10-2.noarch.rpm\n\n  # Install PostgreSQL 10\n  sudo yum -y install postgresql10 postgresql10-contrib postgresql10-server postgresql10-plpython  \n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.5\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.5\/bin\/postgresql95-setup\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.6\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.6\/bin\/postgresql96-setup\"\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/10.2\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-10.2\/bin\/postgresql10-setup\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n#run initdb\nsudo $PG_SETUP_CMD initdb\n\n#start and stop postgresql to make sure DB creates the required directories\nsudo systemctl start $SERVICE_NAME\nsudo systemctl stop $SERVICE_NAME\n\n##copy the created postgres directory to a temp directory\nsudo mkdir \/tmp\/pgsql\n\nsudo mv $PG_DATA_HOME \/tmp\/pgsql\n\n#Create directory , fix permissions and Mount LVM\nsudo mkdir $PG_DATA_HOME\/\nsudo mount -o noatime,barrier=0 \/dev\/pgDataVG\/pgDataLV $PG_DATA_HOME\/ \n\nsudo mkdir $PG_DATA_HOME\/pg_xlog\nsudo mount -o noatime,barrier=0 \/dev\/pgLogVG\/pgLogLV $PG_DATA_HOME\/pg_xlog\n\nsudo chown -R postgres:postgres $PG_DATA_HOME\/\n\n#move the xlog to the new LVM\nsudo find \/tmp\/pgsql\/data\/pg_xlog -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/pg_xlog\/ {} +\n\n#remove pg_xlog from temp dir to avoid being copied again\nsudo rm -rf \/tmp\/pgsql\/data\/pg_xlog\n\n#move the pgsql directory to the LVM\nsudo find \/tmp\/pgsql\/data -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/ {} +\n\nsudo chmod -R 0700 $PG_DATA_HOME\n\n#enable service on boot\nsudo systemctl enable $SERVICE_NAME\n\n#add mount points to \/etc\/fstab\necho \"\/dev\/mapper\/pgDataVG-pgDataLV $PG_DATA_HOME ext4 rw,seclabel,noatime,nobarrier,stripe=4096,data=ordered 0 0\" | sudo tee -a \/etc\/fstab\necho \"\/dev\/mapper\/pgLogVG-pgLogLV $PG_DATA_HOME\/pg_xlog ext4 rw,seclabel,noatime,nobarrier,stripe=2048,data=ordered 0 0\" | sudo tee -a  \/etc\/fstab\n\n\nsudo systemctl status $SERVICE_NAME\nsudo systemctl restart $SERVICE_NAME\nsudo systemctl status $SERVICE_NAME\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Setup Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"33fab652-fa53-6acb-52a7-4b692147976d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_USER=\"@@{DB_USER}@@\"\nDB_NAME=\"@@{DB_NAME}@@\"\nDB_PASSWORD=\"@@{DB_PASSWORD}@@\"\n\n#sudo -i -u postgres sh -c \"createuser -d -E -R -S ${DB_USER}\";\nsudo -i -u postgres sh -c \"createdb -O ${DB_USER} -E UTF-8 -T template0 ${DB_NAME}\";\nsudo -i -u postgres psql -c \"ALTER USER postgres PASSWORD '${DB_PASSWORD}' ; \"\n#sudo -i -u postgres psql -c \"ALTER USER ${DB_USER} PASSWORD '${DB_PASSWORD}' ; \"\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create DB and User"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\necho \"local   all             postgres                                     trust\nhost    all             postgres             ::1\/128                 md5\nhost    all             postgres              127.0.0.1\/32           md5\" | sudo tee \/var\/lib\/pgsql\/9.6\/data\/pg_hba.conf\necho \"listen_addresses = '*'\" | sudo tee -a \/var\/lib\/pgsql\/9.6\/data\/postgresql.conf \nsleep 2;\n\nsudo systemctl restart postgresql-9.6\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Configure Era Access"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/clusters","response_paths":{"CLUSTER_ID":"$[0].id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"608b3a71-32a9-5653-c535-193b9cf734d0","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Cluster ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""},{"status":"FAILURE","code":422,"type":""}],"request_body":"{\n    \"status\": \"8\",\n    \"timeMachineId\": null,\n    \"forcedInstall\": true,\n    \"ownerId\": \"1\",\n    \"type\": \"register_host\",\n    \"actionArguments\": [],\n    \"vmInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"application_version\",\n        \"value\": \"@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }],\n    \"actionHeader\": [{\n        \"name\": \"cloudId\",\n        \"value\": \"@@{CLUSTER_ID}@@\"\n    }, {\n        \"name\": \"cloudName\",\n        \"value\": null\n    }, {\n        \"name\": \"host_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_name\",\n        \"value\": \"\"\n    }, {\n        \"name\": \"host_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"host_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }]\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"03aeafdc-017e-8466-ccde-72a86a90b411","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register DB Server"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"830ebb80-f852-fc97-1570-668e266cca32","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Servers Operation"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"264bebed-214b-d30c-5318-6593a4f889f9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLA_NAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"5fd2c982-787b-a190-0e53-436549ee4ce9","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get SLA ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"abeb71ba-254f-9782-2525-edc253625d5e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n    \"vmAdd\": true,\n    \"applicationInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"db_user\",\n        \"value\": \"@@{DB_USER}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"switch_log\",\n        \"value\": true\n    }, {\n        \"name\": \"allow_multiple_databases\",\n        \"value\": true\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"create_era_drive\",\n        \"value\": true\n    }, {\n        \"name\": \"vm_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"vm_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"database_name\",\n        \"value\": \"@@{DB_NAME}@@\"\n    }, {\n        \"name\": \"db_password\",\n        \"value\": \"@@{DB_PASSWORD}@@\"\n    }],\n    \"forcedInstall\": true,\n    \"clusterId\": \"@@{CLUSTER_ID}@@\",\n    \"tags\": [],\n    \"timeMachineInfo\": {\n        \"name\": \"@@{DB_NAME}@@_TM\",\n        \"description\": \"\",\n        \"slaId\": \"@@{SLA_ID}@@\",\n        \"schedule\": {\n            \"snapshotTimeOfDay\": {\n                \"hours\": @@{SCHEDULE_HOURS}@@,\n                \"minutes\": @@{SCHEDULE_MINUTES}@@,\n                \"seconds\": @@{SCHEDULE_SECONDS}@@\n            },\n            \"continuousSchedule\": {\n                \"enabled\": true,\n                \"logBackupInterval\": \"@@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@\",\n                \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n            },\n            \"weeklySchedule\": {\n                \"enabled\": true,\n                \"dayOfWeek\": \"@@{DAY_OF_WEEK}@@\"\n            },\n            \"monthlySchedule\": {\n                \"enabled\": true,\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"quartelySchedule\": {\n                \"enabled\": true,\n                \"startMonth\": \"@@{QUARTER_START_MONTH}@@\",\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"yearlySchedule\": {\n                \"enabled\": false,\n                \"dayOfMonth\": 31,\n                \"month\": \"DECEMBER\"\n            }\n        },\n        \"tags\": [],\n        \"autoTuneLogDrive\": true\n    },\n    \"applicationSlaName\": \"@@{SLA_NAME}@@\",\n    \"applicationType\": \"postgres_database\",\n    \"autoTuneStagingDrive\": true,\n    \"eraBaseDirectory\": \"\/opt\/era_base\",\n    \"applicationHost\": \"@@{address}@@\",\n    \"vmIp\": \"@@{address}@@\",\n    \"vmUsername\": \"@@{db_server_cred.username}@@\",\n    \"vmSSHPrivateKey\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\",\n    \"applicationName\": \"@@{DB_NAME}@@\",\n    \"vmDescription\": \"@@{DB_NAME}@@\"\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"8430aab9-9bdb-e6c9-ca61-70f59184f759","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register Database"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"db4594dd-072b-205e-a085-f1fb145fe627","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Operation"}],"description":"","message_list":[],"uuid":"2c8ef6b0-d9ab-46cc-884e-84eb527a07d0","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98"},"name":"8b1f1a7b_runbook"},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"ee8bedbe_dag"}],"description":"","message_list":[],"uuid":"af16f04e-9e2e-42b7-ab1d-1d41d0700084","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9"},"name":"faacff5d_runbook"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Uninstall_Crb_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}],"description":"","message_list":[],"uuid":"52aa9058-c314-484e-ad98-b4cadc28e7ae","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"6b517fc0-d034-458b-ac15-81362bb7445c"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for deleting an application. Deletes created VMs as well","message_list":[],"uuid":"bc2a4adc-c367-41ca-960a-de3b0da0a8f1","name":"action_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"b8e597e6-f02f-4614-ad1d-225427ff2958","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"1c79ea6a-3585-4bd7-9ae7-de44fcb4666f"},{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"978ca144-326a-4933-b2fc-fbe7c9795875"},{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"ea76ebba-795c-4a9e-b026-6a990e6d1446"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"1c79ea6a-3585-4bd7-9ae7-de44fcb4666f"},"edge_type":"inherent","type":"","uuid":"a8930b85-bf80-4166-a9e4-3fb9906ae644","to_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"978ca144-326a-4933-b2fc-fbe7c9795875"}},{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"978ca144-326a-4933-b2fc-fbe7c9795875"},"edge_type":"inherent","type":"","uuid":"dcbe0046-4571-4667-b593-25041a10f546","to_task_reference":{"kind":"app_task","name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"ea76ebba-795c-4a9e-b026-6a990e6d1446"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"1c79ea6a-3585-4bd7-9ae7-de44fcb4666f","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"978ca144-326a-4933-b2fc-fbe7c9795875","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"fe42eb38_runbook","uuid":"1f4b2e17-4354-4c08-8bb6-74c8ba0ca573"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"ea76ebba-795c-4a9e-b026-6a990e6d1446","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"52aa9058-c314-484e-ad98-b4cadc28e7ae"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__uninstall_CRb_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}],"description":"","message_list":[],"uuid":"c920abe9-ccff-411b-b7a4-d218c245756d","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"b8e597e6-f02f-4614-ad1d-225427ff2958"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for deleting an application. Does not delete created VMs","message_list":[],"uuid":"ecee2831-b38d-487f-b02e-6f6476c95d38","name":"action_soft_delete","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"bc0235f5-1d4a-4093-824a-ea199f4019ca","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"de3feb2c-8600-4a28-8c86-720e50e10592"},{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"bf41a431-6fa8-4573-bedb-5eadc35650ff"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"de3feb2c-8600-4a28-8c86-720e50e10592"},"edge_type":"inherent","type":"","uuid":"1ea6e590-0aa9-4aaf-93eb-69a365f27d5f","to_task_reference":{"kind":"app_task","name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"bf41a431-6fa8-4573-bedb-5eadc35650ff"}}],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"de3feb2c-8600-4a28-8c86-720e50e10592","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"SYS_GEN__Runbook_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"c64c0489-8a38-40e3-ae8c-58e075f7e015"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__soft_delete_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"},{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"SOFT_DELETE_ELEMENT","uuid":"bf41a431-6fa8-4573-bedb-5eadc35650ff","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Package_Element_Delete_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}],"description":"","message_list":[],"uuid":"567a04de-dabf-4002-995f-4a55074d0a74","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"bc0235f5-1d4a-4093-824a-ea199f4019ca"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for starting an application","message_list":[],"uuid":"d3c89169-4f47-4cac-9e7b-52a2366b2278","name":"action_start","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"a0d0784e-1161-45ac-910a-21093cf4cac8","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"925e4c28-898f-4506-aa28-4b3eadea1eff"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"925e4c28-898f-4506-aa28-4b3eadea1eff","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ef6acd35_runbook","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__start_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"9b488747-9e5a-4251-b189-fc4d19ddf4d0","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"a0d0784e-1161-45ac-910a-21093cf4cac8"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for restarting an application","message_list":[],"uuid":"be2eb842-f340-430b-a1ee-824a86e4975c","name":"action_restart","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"e358d652-856b-4c85-b42c-606b4ed4b0f6","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"12422717-d76a-4497-bce4-abdd9a1b574b"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"12422717-d76a-4497-bce4-abdd9a1b574b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"ffd25064_runbook","uuid":"d669393e-4c59-4fea-8c3a-48dd23805821"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__restart_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"5df70224-da6c-4bec-8c4b-ae4f23b8724c","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"e358d652-856b-4c85-b42c-606b4ed4b0f6"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}},{"description":"System action for stopping an application","message_list":[],"uuid":"cde444e9-7f0a-43e0-8cb3-82ae5240d963","name":"action_stop","state":"ACTIVE","critical":true,"attrs":{},"type":"system","runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"0c46ae4e-e422-4709-9430-00a8d30a91c9","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548","uuid":"93ff51ab-54dc-497a-b66e-6b7ea2d7ee7b"}],"state":"ACTIVE","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"CALL_RUNBOOK","uuid":"93ff51ab-54dc-497a-b66e-6b7ea2d7ee7b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"inarg_list":[],"type":"CALL_RUNBOOK","runbook_reference":{"kind":"app_runbook","name":"b81e8f8b_runbook","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"SYS_GEN__stop_CRb_Service_06f3fc75_64a7_46fe_b061_62f48048a548"}],"description":"","message_list":[],"uuid":"5b24235a-56e0-4e46-abf7-8e895d8514f3","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__Composite_DAG_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8","uuid":"0c46ae4e-e422-4709-9430-00a8d30a91c9"},"name":"SYS_GEN__Runbook_Package_2338f9d7_6e48_4ed5_84e0_c7fea732d1d8"}}],"message_list":[],"service_local_reference_list":[{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"}],"uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8","state":"ACTIVE","version":"","editables":{},"type":"DEB","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98","child_tasks_local_reference_list":[{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Install System Packages","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},"edge_type":"user_defined","type":"","uuid":"56b15a2e-857f-8b7c-5c54-361845d0aa9f","to_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"}},{"from_task_reference":{"kind":"app_task","name":"Create Disk Setup","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},"edge_type":"user_defined","type":"","uuid":"523547e8-36f0-a840-5d60-772cd46baead","to_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"}},{"from_task_reference":{"kind":"app_task","name":"Install Postgresql","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},"edge_type":"user_defined","type":"","uuid":"7e4989fd-19da-1dd0-ed1c-9d7a1fb256ba","to_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"}},{"from_task_reference":{"kind":"app_task","name":"Setup Postgresql","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},"edge_type":"user_defined","type":"","uuid":"68b15b8f-c3ec-6bed-c7f6-55339fa828ea","to_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"}},{"from_task_reference":{"kind":"app_task","name":"Create DB and User","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},"edge_type":"user_defined","type":"","uuid":"701afd40-3386-42d2-7c23-29e10c83745a","to_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"}},{"from_task_reference":{"kind":"app_task","name":"Configure Era Access","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},"edge_type":"user_defined","type":"","uuid":"ed214671-6b3e-e9b3-f016-aa9569df35ed","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}},{"from_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},"edge_type":"user_defined","type":"","uuid":"c9987dd9-bd3c-12e2-eac4-fabccc53bd41","to_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"}},{"from_task_reference":{"kind":"app_task","name":"Register DB Server","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},"edge_type":"user_defined","type":"","uuid":"a6a75362-5fe1-7bd8-68f8-94b6765dbd40","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"}},{"from_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},"edge_type":"user_defined","type":"","uuid":"89988f4e-2a4c-4f20-5c6e-48d1d8841d8e","to_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"}},{"from_task_reference":{"kind":"app_task","name":"Register Database","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},"edge_type":"user_defined","type":"","uuid":"4cf60df5-81c6-f85e-2373-c35e9bc6c5f2","to_task_reference":{"kind":"app_task","name":"Monitor Register DB Operation","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}},{"from_task_reference":{"kind":"app_task","name":"Monitor Register DB Servers Operation","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},"edge_type":"user_defined","type":"","uuid":"b92c3b3d-03ff-9380-bd96-62626569bfd3","to_task_reference":{"kind":"app_task","name":"Get SLA ID","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"}},{"from_task_reference":{"kind":"app_task","name":"Get Token","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},"edge_type":"user_defined","type":"","uuid":"abc143d3-83b8-bf9e-25cb-1699dab49062","to_task_reference":{"kind":"app_task","name":"Get Cluster ID","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"58ca4a03_dag"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nsudo yum -y upgrade\nsudo curl -O http:\/\/dl.fedoraproject.org\/pub\/epel\/7\/x86_64\/e\/epel-release-7-10.noarch.rpm\nsudo rpm --import https:\/\/www.elrepo.org\/RPM-GPG-KEY-elrepo.org\nsudo rpm -Uvh http:\/\/www.elrepo.org\/elrepo-release-7.0-3.el7.elrepo.noarch.rpm \nsudo rpm -ihv epel-release-7-10.noarch.rpm \n\nsudo yum update -y\nsudo yum -y install htop wget iotop xfs* bc unzip lvm2*\n\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/sysconfig\/selinux\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/selinux\/config\nsudo setenforce 0\n\necho \"System packages are installed\"\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install System Packages"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"SET_VARIABLE","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/auth\/validate?token=true&expire=15\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"TOKEN={0}\".format(json.loads(resp.content)['token'])","eval_variables":["TOKEN"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Token"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\n##############\n#\n# LVM setup script for PostgreSQL . 4 disks for DATA and 2 for logs\n# Data disks are 60GB | Log disks are 20GB \n#\n#############\n\n\n#PGSQL data\nsudo pvcreate \/dev\/sdb \/dev\/sdc \/dev\/sdd \/dev\/sde\nsudo vgcreate pgDataVG \/dev\/sdb \/dev\/sdd \/dev\/sdc \/dev\/sde\nsudo lvcreate -l 100%FREE -i4 -I1M -n pgDataLV pgDataVG          ## Use 1MB to avoid IO amplification \n#lvcreate -l 100%FREE -i4 -I4M -n pgDataLV pgDataVG\n\n\n#PGSQL logs\nsudo pvcreate \/dev\/sdf \/dev\/sdg \nsudo vgcreate pgLogVG \/dev\/sdf \/dev\/sdg\nsudo lvcreate -l 100%FREE -i2 -I1M -n pgLogLV pgLogVG            ## Use 1MB to avoid IO amplification\n#lvcreate -l 100%FREE -i2 -I4M -n pgLogLV pgLogVG\n\n\n#Disable LVM read ahead\nsudo lvchange -r 0 \/dev\/pgDataVG\/pgDataLV\nsudo lvchange -r 0 \/dev\/pgLogVG\/pgLogLV\n\n\n#Format LVMs with ext4 and use nodiscard to make sure format time is fast on Nutanix due to SCSI unmap\nsudo mkfs.ext4 -E nodiscard \/dev\/pgDataVG\/pgDataLV\nsudo mkfs.ext4 -E nodiscard \/dev\/pgLogVG\/pgLogLV\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create Disk Setup"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.5\/redhat\/rhel-7-x86_64\/pgdg-centos95-9.5-3.noarch.rpm\n  sudo yum -y install pgdg-centos95-9.5-3.noarch.rpm\n\n  # Install PostgreSQL 9.5\n  sudo yum -y install postgresql95 postgresql95-contrib postgresql95-server postgresql95-plpython\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.6\/redhat\/rhel-7-x86_64\/pgdg-centos96-9.6-3.noarch.rpm\n  sudo yum -y install pgdg-centos96-9.6-3.noarch.rpm\n\n  # Install PostgreSQL 9.6\n  sudo yum -y install postgresql96 postgresql96-contrib postgresql96-server postgresql96-plpython\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/10\/redhat\/rhel-7-x86_64\/pgdg-centos10-10-2.noarch.rpm\n  sudo yum -y install pgdg-centos10-10-2.noarch.rpm\n\n  # Install PostgreSQL 10\n  sudo yum -y install postgresql10 postgresql10-contrib postgresql10-server postgresql10-plpython  \n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Install Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.5\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.5\/bin\/postgresql95-setup\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.6\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.6\/bin\/postgresql96-setup\"\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/10.2\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-10.2\/bin\/postgresql10-setup\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n#run initdb\nsudo $PG_SETUP_CMD initdb\n\n#start and stop postgresql to make sure DB creates the required directories\nsudo systemctl start $SERVICE_NAME\nsudo systemctl stop $SERVICE_NAME\n\n##copy the created postgres directory to a temp directory\nsudo mkdir \/tmp\/pgsql\n\nsudo mv $PG_DATA_HOME \/tmp\/pgsql\n\n#Create directory , fix permissions and Mount LVM\nsudo mkdir $PG_DATA_HOME\/\nsudo mount -o noatime,barrier=0 \/dev\/pgDataVG\/pgDataLV $PG_DATA_HOME\/ \n\nsudo mkdir $PG_DATA_HOME\/pg_xlog\nsudo mount -o noatime,barrier=0 \/dev\/pgLogVG\/pgLogLV $PG_DATA_HOME\/pg_xlog\n\nsudo chown -R postgres:postgres $PG_DATA_HOME\/\n\n#move the xlog to the new LVM\nsudo find \/tmp\/pgsql\/data\/pg_xlog -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/pg_xlog\/ {} +\n\n#remove pg_xlog from temp dir to avoid being copied again\nsudo rm -rf \/tmp\/pgsql\/data\/pg_xlog\n\n#move the pgsql directory to the LVM\nsudo find \/tmp\/pgsql\/data -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/ {} +\n\nsudo chmod -R 0700 $PG_DATA_HOME\n\n#enable service on boot\nsudo systemctl enable $SERVICE_NAME\n\n#add mount points to \/etc\/fstab\necho \"\/dev\/mapper\/pgDataVG-pgDataLV $PG_DATA_HOME ext4 rw,seclabel,noatime,nobarrier,stripe=4096,data=ordered 0 0\" | sudo tee -a \/etc\/fstab\necho \"\/dev\/mapper\/pgLogVG-pgLogLV $PG_DATA_HOME\/pg_xlog ext4 rw,seclabel,noatime,nobarrier,stripe=2048,data=ordered 0 0\" | sudo tee -a  \/etc\/fstab\n\n\nsudo systemctl status $SERVICE_NAME\nsudo systemctl restart $SERVICE_NAME\nsudo systemctl status $SERVICE_NAME\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Setup Postgresql"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"33fab652-fa53-6acb-52a7-4b692147976d","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nDB_USER=\"@@{DB_USER}@@\"\nDB_NAME=\"@@{DB_NAME}@@\"\nDB_PASSWORD=\"@@{DB_PASSWORD}@@\"\n\n#sudo -i -u postgres sh -c \"createuser -d -E -R -S ${DB_USER}\";\nsudo -i -u postgres sh -c \"createdb -O ${DB_USER} -E UTF-8 -T template0 ${DB_NAME}\";\nsudo -i -u postgres psql -c \"ALTER USER postgres PASSWORD '${DB_PASSWORD}' ; \"\n#sudo -i -u postgres psql -c \"ALTER USER ${DB_USER} PASSWORD '${DB_PASSWORD}' ; \"\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Create DB and User"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\necho \"local   all             postgres                                     trust\nhost    all             postgres             ::1\/128                 md5\nhost    all             postgres              127.0.0.1\/32           md5\" | sudo tee \/var\/lib\/pgsql\/9.6\/data\/pg_hba.conf\necho \"listen_addresses = '*'\" | sudo tee -a \/var\/lib\/pgsql\/9.6\/data\/postgresql.conf \nsleep 2;\n\nsudo systemctl restart postgresql-9.6\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"db_server_cred","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Configure Era Access"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/clusters","response_paths":{"CLUSTER_ID":"$[0].id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"608b3a71-32a9-5653-c535-193b9cf734d0","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get Cluster ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""},{"status":"FAILURE","code":400,"type":""},{"status":"FAILURE","code":422,"type":""}],"request_body":"{\n    \"status\": \"8\",\n    \"timeMachineId\": null,\n    \"forcedInstall\": true,\n    \"ownerId\": \"1\",\n    \"type\": \"register_host\",\n    \"actionArguments\": [],\n    \"vmInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"application_version\",\n        \"value\": \"@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }],\n    \"actionHeader\": [{\n        \"name\": \"cloudId\",\n        \"value\": \"@@{CLUSTER_ID}@@\"\n    }, {\n        \"name\": \"cloudName\",\n        \"value\": null\n    }, {\n        \"name\": \"host_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_name\",\n        \"value\": \"\"\n    }, {\n        \"name\": \"host_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"host_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }]\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"03aeafdc-017e-8466-ccde-72a86a90b411","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register DB Server"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"830ebb80-f852-fc97-1570-668e266cca32","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Servers Operation"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"264bebed-214b-d30c-5318-6593a4f889f9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLA_NAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"5fd2c982-787b-a190-0e53-436549ee4ce9","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Get SLA ID"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"HTTP","uuid":"abeb71ba-254f-9782-2525-edc253625d5e","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"{\n    \"vmAdd\": true,\n    \"applicationInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"db_user\",\n        \"value\": \"@@{DB_USER}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"switch_log\",\n        \"value\": true\n    }, {\n        \"name\": \"allow_multiple_databases\",\n        \"value\": true\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"create_era_drive\",\n        \"value\": true\n    }, {\n        \"name\": \"vm_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"vm_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"database_name\",\n        \"value\": \"@@{DB_NAME}@@\"\n    }, {\n        \"name\": \"db_password\",\n        \"value\": \"@@{DB_PASSWORD}@@\"\n    }],\n    \"forcedInstall\": true,\n    \"clusterId\": \"@@{CLUSTER_ID}@@\",\n    \"tags\": [],\n    \"timeMachineInfo\": {\n        \"name\": \"@@{DB_NAME}@@_TM\",\n        \"description\": \"\",\n        \"slaId\": \"@@{SLA_ID}@@\",\n        \"schedule\": {\n            \"snapshotTimeOfDay\": {\n                \"hours\": @@{SCHEDULE_HOURS}@@,\n                \"minutes\": @@{SCHEDULE_MINUTES}@@,\n                \"seconds\": @@{SCHEDULE_SECONDS}@@\n            },\n            \"continuousSchedule\": {\n                \"enabled\": true,\n                \"logBackupInterval\": \"@@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@\",\n                \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n            },\n            \"weeklySchedule\": {\n                \"enabled\": true,\n                \"dayOfWeek\": \"@@{DAY_OF_WEEK}@@\"\n            },\n            \"monthlySchedule\": {\n                \"enabled\": true,\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"quartelySchedule\": {\n                \"enabled\": true,\n                \"startMonth\": \"@@{QUARTER_START_MONTH}@@\",\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"yearlySchedule\": {\n                \"enabled\": false,\n                \"dayOfMonth\": 31,\n                \"month\": \"DECEMBER\"\n            }\n        },\n        \"tags\": [],\n        \"autoTuneLogDrive\": true\n    },\n    \"applicationSlaName\": \"@@{SLA_NAME}@@\",\n    \"applicationType\": \"postgres_database\",\n    \"autoTuneStagingDrive\": true,\n    \"eraBaseDirectory\": \"\/opt\/era_base\",\n    \"applicationHost\": \"@@{address}@@\",\n    \"vmIp\": \"@@{address}@@\",\n    \"vmUsername\": \"@@{db_server_cred.username}@@\",\n    \"vmSSHPrivateKey\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\",\n    \"applicationName\": \"@@{DB_NAME}@@\",\n    \"vmDescription\": \"@@{DB_NAME}@@\"\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"regex":{},"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","message_list":[],"uuid":"8430aab9-9bdb-e6c9-ca61-70f59184f759","value":"@@{TOKEN}@@","label":"","state":"NOT_VALIDATED","attrs":{"type":""},"editables":{},"is_hidden":false,"type":"LOCAL","options":{},"name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false,"secret_reference":{}}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"POST"},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Register Database"},{"target_any_local_reference":{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"retries":"0","description":"","type":"EXEC","uuid":"db4594dd-072b-205e-a085-f1fb145fe627","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"script_type":"static","type":"","command_line_args":"","exit_status":[],"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"Monitor Register DB Operation"}],"description":"","message_list":[],"uuid":"2c8ef6b0-d9ab-46cc-884e-84eb527a07d0","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98"},"name":"8b1f1a7b_runbook"},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"PostgresPackage","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","description":"","type":"DAG","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"name":"ee8bedbe_dag"}],"description":"","message_list":[],"uuid":"af16f04e-9e2e-42b7-ab1d-1d41d0700084","state":"ACTIVE","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9"},"name":"faacff5d_runbook"}},"variable_list":[],"name":"PostgresPackage"}]},"name":"EraPostgres"},"spec":{"name":"EraPostgres","resources":{"service_definition_list":[{"singleton":false,"name":"Postgres","action_list":[{"description":"System action for creating an application","name":"action_create","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","name":"Postgres"},"retries":"0","description":"","uuid":"a65f7c7c-ebcf-4c4f-a1cf-3343820419c4","child_tasks_local_reference_list":[],"attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[],"name":"6fba9cbb_dag"}],"description":"","uuid":"b8b80915-c631-4a78-ba59-97657ee6f8fc","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"6fba9cbb_dag","uuid":"a65f7c7c-ebcf-4c4f-a1cf-3343820419c4"},"name":"01945104_runbook"},"type":"system","uuid":"1e607e45-7730-40e8-8184-bcdd474fd37e"},{"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","name":"Postgres"},"retries":"0","description":"","uuid":"736029cc-1810-40ec-986d-570ec7eb47fa","child_tasks_local_reference_list":[],"attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[],"name":"8bee20f0_dag"}],"description":"","uuid":"1f4b2e17-4354-4c08-8bb6-74c8ba0ca573","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"8bee20f0_dag","uuid":"736029cc-1810-40ec-986d-570ec7eb47fa"},"name":"fe42eb38_runbook"},"type":"system","uuid":"c377edeb-85ee-4f24-a307-b0c306b1e4b8"},{"description":"System action for restarting an application","name":"action_restart","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","name":"Postgres"},"retries":"0","description":"","uuid":"30df78e8-1d0e-4015-bd7e-29fc86c47931","child_tasks_local_reference_list":[],"attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[],"name":"04cc6e24_dag"}],"description":"","uuid":"d669393e-4c59-4fea-8c3a-48dd23805821","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"04cc6e24_dag","uuid":"30df78e8-1d0e-4015-bd7e-29fc86c47931"},"name":"ffd25064_runbook"},"type":"system","uuid":"39870bd3-8874-4f9a-95fe-5c3487c10278"},{"description":"System action for starting an application","name":"action_start","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","name":"Postgres"},"retries":"0","description":"","uuid":"81fdcfec-9684-4258-acfa-cba90ca5ecdb","child_tasks_local_reference_list":[],"attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[],"name":"9d7e4dfb_dag"}],"description":"","uuid":"8d8cae03-7855-46ed-ad3c-6158ef5ff211","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"9d7e4dfb_dag","uuid":"81fdcfec-9684-4258-acfa-cba90ca5ecdb"},"name":"ef6acd35_runbook"},"type":"system","uuid":"2573dfd2-8005-461d-8f10-5c1cc74510eb"},{"description":"System action for stopping an application","name":"action_stop","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","name":"Postgres"},"retries":"0","description":"","uuid":"843dd758-1949-4395-82fe-cb54465139eb","child_tasks_local_reference_list":[],"attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[],"name":"897e9b24_dag"}],"description":"","uuid":"b9a05d41-0adf-4cba-a7a6-99f498c19f72","variable_list":[],"main_task_local_reference":{"kind":"app_task","name":"897e9b24_dag","uuid":"843dd758-1949-4395-82fe-cb54465139eb"},"name":"b81e8f8b_runbook"},"type":"system","uuid":"5e01d291-b259-486e-ae11-631a7163ab29"}],"description":"","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","uuid":"fc467edd-a5ee-65a5-0cbb-02b248bdc040","name":"TOKEN","value":"","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"0c9c619a-6313-4c05-9b8b-94bacf4b1137","name":"SCHEDULE_HOURS","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"0bded42a-ebde-1e2f-2f6d-b8cc2c51e315","name":"SCHEDULE_MINUTES","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"72987114-8a60-ffbf-1c75-f89a7d0efad5","name":"SCHEDULE_SECONDS","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"00f318f6-010f-aab2-3085-7e5cce796695","name":"SERVICE_NAME","value":"postgresql-9.6","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"depends_on_list":[]}],"substrate_definition_list":[{"name":"PostgreSQL","action_list":[{"critical":false,"type":"fragment","uuid":"3f5bb9c2-9388-d7d6-1026-759244b075d2","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"72560c7d-15c0-6cf1-8b42-b1c779a0d982"},"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"name":"4b0c18f5_dag","child_tasks_local_reference_list":[],"attrs":{"edges":[]},"type":"DAG","variable_list":[],"uuid":"72560c7d-15c0-6cf1-8b42-b1c779a0d982"}],"name":"8e143af6_runbook","variable_list":[],"uuid":"f9fc2966-0383-3f2f-c1e8-9be354c318fe"},"name":"pre_action_create"},{"critical":false,"type":"fragment","uuid":"492bf4fd-713d-988f-c3a6-296e0e801cc8","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"379ef25c-90f1-dd20-66ee-efa0c652902c"},"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"name":"9fd599cd_dag","child_tasks_local_reference_list":[],"attrs":{"edges":[]},"type":"DAG","variable_list":[],"uuid":"379ef25c-90f1-dd20-66ee-efa0c652902c"}],"name":"bd422cbf_runbook","variable_list":[],"uuid":"9c19d663-f9e3-20e7-e0a6-267f8768ee87"},"name":"post_action_delete"}],"uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4","readiness_probe":{"connection_type":"SSH","retries":"5","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"editables":{"readiness_probe":{"connection_type":true,"retries":true,"delay_secs":true,"connection_port":true},"create_spec":{"resources":{"nic_list":{"0":{"subnet_reference":true}},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"guest_customization":true,"disk_list":{"0":{"data_source_reference":true,"device_properties":{"disk_address":{"adapter_type":true},"device_type":true}}}},"categories":true,"name":true}},"os_type":"Linux","type":"AHV_VM","create_spec":{"name":"lin-@@{calm_array_index}@@-@@{calm_time}@@","resources":{"nic_list":[{"subnet_reference":{"uuid":"efc034e3-b50e-4a48-b02d-25036aeb8bd3"}}],"num_vcpus_per_socket":2,"num_sockets":2,"memory_size_mib":8192,"boot_config":{"boot_device":{"disk_address":{"device_index":0,"adapter_type":"SCSI"}}},"guest_customization":{"cloud_init":{"user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{db_server_cred.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"}},"account_uuid":"efc034e3-b50e-4a48-b02d-25036aeb8bd3","disk_list":[{"data_source_reference":{"kind":"image","name":"Centos-7.4-1801-01","uuid":"96e7ffa6-6457-4932-a9e8-ba009cd88ddf"},"device_properties":{"device_type":"DISK","disk_address":{"device_index":0,"adapter_type":"SCSI"}}},{"device_properties":{"disk_address":{"device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192},{"device_properties":{"disk_address":{"device_index":2,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192},{"device_properties":{"disk_address":{"device_index":3,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192},{"device_properties":{"disk_address":{"device_index":4,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192},{"device_properties":{"disk_address":{"device_index":5,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192},{"device_properties":{"disk_address":{"device_index":6,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":8192}]}},"variable_list":[],"description":""}],"credential_definition_list":[{"username":"centos","description":"","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"c2fa8ccc-b43d-4d14-b38a-25130fb6c158"}}},"editables":{"username":true,"secret":true},"type":"KEY","name":"db_server_cred"},{"username":"admin","description":"","uuid":"6f127226-e987-443c-ac4c-daa9796b9af8","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"51cbb30d-9606-43a6-9e62-e209dc3b86ff"}}},"editables":{"username":true,"secret":true},"type":"PASSWORD","name":"era_web_cred"}],"type":"USER","app_profile_list":[{"deployment_create_list":[{"name":"f6be2786_deployment","action_list":[],"package_local_reference_list":[{"kind":"app_package","name":"Package2","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"}],"description":"","depends_on_list":[],"min_replicas":"1","max_replicas":"1","published_service_local_reference_list":[],"editables":{"min_replicas":true,"max_replicas":true},"substrate_local_reference":{"kind":"app_substrate","name":"Era_PostgreSQL_DB","uuid":"a1b913ee-dbad-4d23-88ee-86bc78ea9eb4"},"type":"GREENFIELD","variable_list":[],"uuid":"55d915ec-e34e-4bd5-aa49-1f070f437760"}],"description":"","action_list":[{"critical":false,"type":"user","uuid":"041e24b3-c90d-c9bb-2552-fd0719137fea","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"54b5f8c6-087d-8020-84d2-ac0a261f339a"},"task_definition_list":[{"uuid":"54b5f8c6-087d-8020-84d2-ac0a261f339a","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"8ae27cfd-a8a9-3bf8-83c5-4c6a5d260463"}],"attrs":{"edges":[]},"type":"DAG","variable_list":[],"name":"2b1c9885_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Create SLA","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n  \"name\": \"@@{SLANAME}@@\",\n  \"description\": \"@@{SLA_DESCRIPTION}@@\",\n  \"continuousRetention\": \"@@{CONTINUOUS_RETENTION}@@\",\n  \"dailyRetention\": \"@@{DAILY_RETENTION}@@\",\n  \"weeklyRetention\": \"@@{WEEKLY_RETENTION}@@\",\n  \"monthlyRetention\": \"@@{MONTHLY_RETENTION}@@\",\n  \"quarterlyRetention\": \"@@{QUARTERLY_RETENTION}@@\",\n  \"yearlyRetention\": \"@@{YEARLY_RETENTION}@@\",\n  \"systemSla\": \"true\"\n  \n}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas","response_paths":{},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"8ae27cfd-a8a9-3bf8-83c5-4c6a5d260463"}],"name":"c8cd76ed_runbook","variable_list":[{"val_type":"STRING","uuid":"2e42814a-0ec6-4ed7-3ae0-110af3789d88","name":"SLANAME","value":"SLA1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"5594c301-4e14-afda-e26a-b4fdb25c3676","name":"SLA_DESCRIPTION","value":"Test SLA1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"f7a3ee14-2cda-2830-310b-a668be545fe2","name":"CONTINUOUS_RETENTION","value":"7","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"56b61c88-e46e-3cd5-f4da-efe3b6cdef8d","name":"DAILY_RETENTION","value":"30","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"bf4f87f2-11ab-164f-b218-c6b1a99879bc","name":"WEEKLY_RETENTION","value":"8","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"ab0e6a2a-af3c-2ae0-1f4d-1d32837df64a","name":"MONTHLY_RETENTION","value":"6","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"0705b85d-79c4-b709-f0ad-92fb29711ab1","name":"QUARTERLY_RETENTION","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"90c462d0-c0cb-3bf6-a10c-205159fe65b4","name":"YEARLY_RETENTION","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"b4c300d9-9f66-c139-8b9b-c7b4faf3aec1"},"name":"Create SLA"},{"critical":false,"type":"user","uuid":"369f9e9f-5142-2caa-1a8d-ddf483cb9fa8","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"7ba49280-1b45-1119-f3ee-08172bb25d15"},"task_definition_list":[{"uuid":"7ba49280-1b45-1119-f3ee-08172bb25d15","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e"},{"kind":"app_task","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"},{"kind":"app_task","uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e"},"uuid":"bc1cc3c4-8db5-af35-35d7-50a4f211a716","to_task_reference":{"kind":"app_task","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"}},{"from_task_reference":{"kind":"app_task","uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651"},"uuid":"bcbedc6c-2323-9357-561a-445e74d3c543","to_task_reference":{"kind":"app_task","uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"}}]},"type":"DAG","variable_list":[],"name":"1e5ccf87_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"c84584d1-47d5-8321-cd02-552f6675bf9e"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Update TM","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/new\"\nresp_out = {}\n\n\npayload = \"\"\"\n{\n    \"name\":\"@@{NEW_TM_NAME}@@\",\n    \"description\":\"era_pg_db_tm\",\n    \"id\":\"@@{TM_ID}@@\",\n    \"slaId\":\"@@{SLA_ID}@@\",\n    \"schedule\":{\n        \"snapshotTimeOfDay\":{\n            \"hours\": @@{SCHEDULE_HOURS}@@,\n            \"minutes\": @@{SCHEDULE_MINUTES}@@,\n            \"seconds\": @@{SCHEDULE_SECONDS}@@\n        },\n        \"continuousSchedule\":{\n            \"enabled\":true,\n            \"logBackupInterval\": @@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@,\n            \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n        },\n        \"weeklySchedule\":{\n            \"enabled\":true,\n            \"dayOfWeek\":\"@@{DAY_OF_WEEK}@@\"\n        },\n        \"monthlySchedule\":{\n            \"enabled\":true,\n            \"dayOfMonth\":@@{DAY_OF_MONTH}@@\n        },\n        \"quartelySchedule\":{\n            \"enabled\":true,\n            \"startMonth\":\"@@{QUARTER_START_MONTH}@@\",\n            \"dayOfMonth\": @@{DAY_OF_MONTH}@@\n        },\n        \"yearlySchedule\":{\n            \"enabled\":false,\n            \"dayOfMonth\":31,\n            \"month\":\"DECEMBER\"\n        }\n    },\n    \"tags\":[]\n}\n\"\"\"\n\n# Update Time Machine\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, params=payload, headers=headers)\nresp_out = json.loads(resp.content)\nprint resp_out\n  \nif \"status_code\" in resp_out and  resp_out[\"status_code\"] != 200:\n  print \"Time machine update is failed for @@{TM_NAME}@@\"\n  exit(1)\n  \n\n  "},"type":"EXEC","variable_list":[],"uuid":"c7193129-1415-cd4d-7201-d0d2b92150ff"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get SLA ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLANAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"350be1a9-7bb2-f188-20fd-e421ac6ff651"}],"name":"e5ae1685_runbook","variable_list":[{"val_type":"STRING","is_mandatory":true,"name":"TM_NAME","data_type":"BASE","uuid":"cc4b1cfd-7dd0-e052-00b3-fdea9a9c2799","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","options":{"type":"PREDEFINED"},"description":""},{"val_type":"STRING","uuid":"8f9cda1f-0105-c379-19a1-33937a44b849","name":"SLANAME","value":"SLA1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"7cf646ed-b4f0-d562-b83c-3261fc26869c","name":"SCHEDULE_HOURS","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"e4e19306-53a7-f539-ef16-63e3d56073e8","name":"SCHEDULE_MINUTES","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"4567df0f-4e44-e699-0485-29dd35e49d50","name":"SCHEDULE_SECONDS","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"9489eb92-1041-38ee-5cdb-15268405bf8f","name":"LOG_CATCHUP_INTERVAL_IN_MINUTE","value":"40","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"08e10b5c-caf9-e139-cc02-ceb0daa33518","name":"SNAPSHOT_PER_DAY","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"3689cfb1-317b-8eba-5145-ccb9c74d3dee","name":"DAY_OF_WEEK","value":"TUESDAY","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"0ad4a60b-4911-f891-6a5d-6acbe2fa0bbc","name":"DAY_OF_MONTH","value":"26","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"de758b5c-4021-d27c-1c5e-a14062f6eaf2","name":"QUARTER_START_MONTH","value":"FEBRUARY","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"97ce49a9-548c-4cff-d6b7-5c64034a261e","name":"NEW_TM_NAME","value":"era_pg_db1_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"2ebe2c7d-12ab-6350-30a3-c7add96bbcc5"},"name":"Update Time Machine"},{"critical":false,"type":"user","uuid":"21e0f5ba-588e-be21-b922-5a540aadd1c8","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"f9fb22bc-bdc3-c33d-e113-9f57f8af47ce"},"task_definition_list":[{"uuid":"f9fb22bc-bdc3-c33d-e113-9f57f8af47ce","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"78995629-50eb-cf3f-7cd2-9513fea4b5c9"}],"attrs":{"edges":[]},"type":"DAG","variable_list":[],"name":"ff7579d0_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Postgresql Service","child_tasks_local_reference_list":[],"attrs":{"login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"},"script_type":"sh","script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\nOPERATION=\"@@{OPERATION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\nsudo systemctl $OPERATION $SERVICE_NAME\nsleep 2;\nsudo systemctl status $SERVICE_NAME "},"type":"EXEC","variable_list":[],"uuid":"78995629-50eb-cf3f-7cd2-9513fea4b5c9"}],"name":"1bcaea31_runbook","variable_list":[{"val_type":"STRING","uuid":"64af1b43-d972-ed35-9771-3046cdf3500b","name":"OPERATION","value":"restart","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"c528d3c9-2940-fb13-027c-9b39940b0c90"},"name":"Manage Postgresql Service"},{"critical":false,"type":"user","uuid":"63feda16-272b-d581-0250-734b3bd356b5","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"a3f3a8db-af06-0496-e77c-2a6217da69c6"},"task_definition_list":[{"uuid":"a3f3a8db-af06-0496-e77c-2a6217da69c6","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284"},{"kind":"app_task","uuid":"a52ab74f-fd53-49c7-a000-febab9156cca"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284"},"uuid":"3d9fb1cb-8632-58f7-687a-c771f0be5184","to_task_reference":{"kind":"app_task","uuid":"a52ab74f-fd53-49c7-a000-febab9156cca"}}]},"type":"DAG","variable_list":[],"name":"0130bcb4_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"type":"HTTP","variable_list":[],"uuid":"80603f8e-7347-9cc3-ebdf-f39c19212284"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Take Snapshots ","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n  \"actionHeader\": [\n    {\n      \"name\": \"snapshotName\",\n      \"value\": \"@@{SNAPSHOTNAME}@@\"\n    }\n  ] \n}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/snapshots","retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"a52ab74f-fd53-49c7-a000-febab9156cca"}],"name":"cbc09bc9_runbook","variable_list":[{"val_type":"STRING","regex":{"should_validate":false,"value":"^.*$"},"is_mandatory":true,"name":"TM_NAME","data_type":"BASE","uuid":"e28565af-f810-dc94-7911-bd50f85fab4c","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","options":{"type":"PREDEFINED"},"description":""},{"val_type":"STRING","uuid":"ea8486f6-65a8-9bcb-8212-2d90796f0f2a","name":"SNAPSHOTNAME","value":"Test_SNAP_1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"af8b729a-db6a-5c05-e9fa-eca0ad3df263"},"name":"Create Snapshot"},{"critical":false,"type":"user","uuid":"c3c9eb6c-a573-c2c3-83c5-f07ce1022d40","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"f9032724-fc4b-0670-4c62-ab8df23ec63f"},"task_definition_list":[{"uuid":"f9032724-fc4b-0670-4c62-ab8df23ec63f","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f"},{"kind":"app_task","uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f"},"uuid":"abb6aab7-7d65-fd06-d7b5-3d2abcffcdd6","to_task_reference":{"kind":"app_task","uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a"}}]},"type":"DAG","variable_list":[],"name":"3bced3bb_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get SLA ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLANAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"e6bfd40f-704b-3d43-e23c-c55469c8052f"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Delete SLA","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/@@{SLA_ID}@@","retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"method":"DELETE"},"type":"HTTP","variable_list":[],"uuid":"ac4cf74b-e386-b13b-e595-aea2c4b01c9a"}],"name":"a934e608_runbook","variable_list":[{"val_type":"STRING","is_mandatory":true,"uuid":"aa42f1ec-cf40-bd53-1400-f276615195c5","name":"SLANAME","value":"TestSLA","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","options":{"type":"PREDEFINED"},"description":""}],"uuid":"d6a28cf0-6476-a01e-5fed-66d277609b7e"},"name":"Delete SLA"},{"critical":false,"type":"user","uuid":"651651a2-08c2-0ec4-3443-5bd3f0413578","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"dadc880d-e379-acb6-1948-1f3d6c9fb315"},"task_definition_list":[{"uuid":"dadc880d-e379-acb6-1948-1f3d6c9fb315","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa"},{"kind":"app_task","uuid":"ffb0202a-9577-eec0-3939-52cf5e243072"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa"},"uuid":"358125b0-423f-9692-3ecd-9c5e26124934","to_task_reference":{"kind":"app_task","uuid":"ffb0202a-9577-eec0-3939-52cf5e243072"}}]},"type":"DAG","variable_list":[],"name":"cabe4447_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"ead53ecd-de9a-28ab-f874-9749a5cea9fa"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Do Log CatchUp","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n  \"actionHeader\": [\n    {\n      \"name\": \"switch_log\",\n      \"value\": \"true\"\n    }\n  ] \n}\n","headers":[],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/log-catchups","response_paths":{"operationId":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"ffb0202a-9577-eec0-3939-52cf5e243072"}],"name":"8c3933d2_runbook","variable_list":[{"val_type":"STRING","uuid":"3a9a62dd-5b99-49f2-e9a4-0acb4a4caaec","name":"TM_NAME","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"b03d2818-4ab7-fe56-3838-8e6890aec197"},"name":"Log Catchup"},{"critical":false,"type":"user","uuid":"a541171d-1669-e633-6635-39518a06e8b1","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"fbfaf12d-5048-2cae-b351-3898eb653302"},"task_definition_list":[{"uuid":"fbfaf12d-5048-2cae-b351-3898eb653302","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff"},{"kind":"app_task","uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4"},{"kind":"app_task","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"},{"kind":"app_task","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},{"kind":"app_task","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},"uuid":"686ae9a8-3272-b7a9-c387-c6a38c602f86","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},"uuid":"68ffc5c7-2835-5347-c5f8-598cc90c42e7","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},"uuid":"40871ac2-1bc0-be41-c69e-8e7e5854dcbd","to_task_reference":{"kind":"app_task","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"}},{"from_task_reference":{"kind":"app_task","uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"},"uuid":"fa4df40e-6e4d-d8e6-3d96-5edd4d478503","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff"},"uuid":"31cdcf77-c57a-b311-c4ae-7a790ad043bb","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4"},"uuid":"83bc2bfb-c703-ecfd-7f8f-7bf49d7ec99d","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}},{"from_task_reference":{"kind":"app_task","uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},"uuid":"cb613227-cd9b-8b4b-70e3-19341ea4a5f1","to_task_reference":{"kind":"app_task","uuid":"381681c5-2a38-725f-be49-e5e0d727274d"}}]},"type":"DAG","variable_list":[],"name":"90a0579d_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get Compute Profile ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Compute&engine=postgres_database&name=@@{COMPUTE_PROFILE}@@","response_paths":{"COMPUTE_PROFILE_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"c20eb366-b057-04a7-1bda-c04b3ec835ff"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get Network Profile ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Network&engine=postgres_database&name=@@{NETWORK_PROFILE}@@","response_paths":{"NETWORK_PROFILE_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"804c9cb2-bb52-6b5b-97db-bfcaae3a4fe4"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get DB Parameter Profile ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=Database_Parameter&engine=postgres_database&name=@@{DB_PARAMS_PROFILE}@@","response_paths":{"DB_PARAMS_PROFILE_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"b612e6c8-5194-3f04-4df0-3b1bebbd1534"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Do Clone DB","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n  \"cloneName\": \"@@{CLONE_NAME}@@\",\n  \"cloneDescription\": \"\",\n  \"timeMachineId\": \"@@{TM_ID}@@\",\n  \"snapshotId\": null,\n  \"pitrTimestamp\": \"@@{PITR_TIME}@@\",\n  \"timeZone\": \"Asia\/Calcutta\",\n  \"latestSnapshot\": false,\n  \"newImplementation\": false,\n  \"tags\": [],\n  \"cloneInfo\": [\n    {\n      \"name\": \"vm_name\",\n      \"value\": \"@@{VM_NAME}@@\"\n    },\n    {\n      \"name\": \"working_dir\",\n      \"value\": \"\/tmp\"\n    },\n    {\n      \"name\": \"era_deploy_base\",\n      \"value\": \"\/opt\/era_base\"\n    },\n    {\n      \"name\": \"create_dbserver\",\n      \"value\": \"true\"\n    },\n    {\n      \"name\": \"compute_profile_id\",\n      \"value\": \"@@{COMPUTE_PROFILE_ID}@@\"\n    },\n    {\n      \"name\": \"network_profile_id\",\n      \"value\": \"@@{NETWORK_PROFILE_ID}@@\"\n    },\n    {\n      \"name\": \"client_public_key\",\n      \"value\": \"@@{CLIENT_PUB_KEY}@@\"\n    },\n    {\n      \"name\": \"db_password\",\n      \"value\": \"@@{DB_PASSWORD}@@\"\n    },\n    {\n      \"name\": \"db_parameter_profile_id\",\n      \"value\": \"@@{DB_PARAMS_PROFILE_ID}@@\"\n    }\n  ]\n}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/clones","retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"381681c5-2a38-725f-be49-e5e0d727274d"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"15d070cb-e622-497d-2a61-b200bc9c4f5a"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM Capability","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@\/capability","response_paths":{"SNAPSHOT_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"e0b803b9-7e1b-771e-f1a4-091cbfd51267"}],"name":"9e4e6017_runbook","variable_list":[{"val_type":"STRING","uuid":"44dc8d12-dd78-5739-f042-6282c8b081ef","name":"COMPUTE_PROFILE","value":"DEFAULT_OOB_COMPUTE","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"bcc97b43-7675-4e13-cb64-b9bb237d3f89","name":"NETWORK_PROFILE","value":"DEFAULT_OOB_NETWORK","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"3bc20aa4-7931-e0b4-1981-607ee33a9413","name":"DB_PARAMS_PROFILE","value":"DEFAULT_POSTGRES_PARAMS","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"9f69036c-89c3-199f-72a6-7f44854bce07","name":"SNAPSHOTNAME","value":"era_auto_snapshot","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"fb2f58ea-b4a9-30a4-92fd-45ca8b4203b4","name":"TM_NAME","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"fccdc6f7-4b10-3371-83e2-1ac39f214b46","name":"CLIENT_PUB_KEY","label":"","attrs":{"is_secret_modified":false},"editables":{"value":true},"type":"SECRET","description":""},{"val_type":"STRING","uuid":"3baf2445-6c2b-8f43-7be7-5e13ba8b5b23","name":"DB_PASSWORD","label":"","attrs":{"is_secret_modified":false},"editables":{"value":true},"type":"SECRET","description":""},{"val_type":"STRING","uuid":"b9da6a49-7588-db93-9989-f59d502d5c65","name":"CLONE_NAME","value":"era_pg_db_clone","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"e76575f6-8869-80ed-7b3f-234c3bebff00","name":"VM_NAME","value":"era_pg_db_clone_vm","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"f4ded61e-df3d-f516-10b2-6a7a076d1d07","name":"PITR_TIME","value":"2019-03-04 08:47:00","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"78019a4c-eb44-db86-8faf-e4fce98521a7"},"name":"Clone DB"},{"critical":false,"type":"user","uuid":"579f3b63-f85f-d12d-ace1-c6bb4f69d2b7","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"67b48f8b-6d29-f105-ca58-00ab6cdd6e56"},"task_definition_list":[{"uuid":"67b48f8b-6d29-f105-ca58-00ab6cdd6e56","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"},{"kind":"app_task","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"},{"kind":"app_task","uuid":"aade2394-eddd-f1db-46d2-bc74c6421793"},{"kind":"app_task","uuid":"965a164e-187f-7812-45be-1b95c6022cde"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"},"uuid":"35450be8-1584-7a96-6f1e-9015cfd25512","to_task_reference":{"kind":"app_task","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"}},{"from_task_reference":{"kind":"app_task","uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"},"uuid":"3bc5bfb6-558d-2ab1-98cd-0e5c6d970fa1","to_task_reference":{"kind":"app_task","uuid":"aade2394-eddd-f1db-46d2-bc74c6421793"}},{"from_task_reference":{"kind":"app_task","uuid":"965a164e-187f-7812-45be-1b95c6022cde"},"uuid":"82154c6d-1e67-8b14-1acc-42812521c6ac","to_task_reference":{"kind":"app_task","uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"}}]},"type":"DAG","variable_list":[],"name":"11de4cba_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Pause TM","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\ntm_id = '@@{TM_ID}@@'\n\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\nurl = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/%s\/status?status=paused\" % tm_id\nresp_out = {}\n\n# Get time machine id\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"Resp Code\", resp.status_code\n\nif resp.status_code != 200:\n  exit(1)\n"},"type":"EXEC","variable_list":[],"uuid":"cd1d3493-0690-6e87-0010-aa0d7f7ac2ce"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM Status","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@","response_paths":{"TM_STATUS":"$.status"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"c9d7a857-5fce-6e23-6783-b1c00e36a35e"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Verify TM Status","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\ntm_status = \"@@{TM_STATUS}@@\"\nexpected_status = \"PAUSED\"\n\nif tm_status != expected_status:\n  print \"Time Machine state(%s) is not in expected state(%s)\" % (tm_status, expected_status) \n  exit(1)\n  \nprint \"Time Machine state(%s) is in expected state(%s)\" % (tm_status, expected_status) "},"type":"EXEC","variable_list":[],"uuid":"aade2394-eddd-f1db-46d2-bc74c6421793"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"type":"","method":"GET"},"type":"HTTP","variable_list":[],"uuid":"965a164e-187f-7812-45be-1b95c6022cde"}],"name":"a06e9d3e_runbook","variable_list":[{"val_type":"STRING","uuid":"0c0dac2b-e74f-f086-393b-66f7c2aaf614","name":"TM_NAME","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"f9813a5e-3aa0-d399-86f6-0e05de598465"},"name":"Pause Time Machine"},{"critical":false,"type":"user","uuid":"7c6eb38d-3694-6da5-bd4f-94a4c459a51f","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"a85242fe-1ec2-5000-39bd-165027c63a31"},"task_definition_list":[{"uuid":"a85242fe-1ec2-5000-39bd-165027c63a31","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12"},{"kind":"app_task","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"},{"kind":"app_task","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"},{"kind":"app_task","uuid":"4c8163fc-5e8d-05be-484c-69453b24a920"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12"},"uuid":"40bbb424-e39c-c344-582c-0ba20d6ca37c","to_task_reference":{"kind":"app_task","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"}},{"from_task_reference":{"kind":"app_task","uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"},"uuid":"e38f6d77-6929-e36b-a9ab-0774e0cee82c","to_task_reference":{"kind":"app_task","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"}},{"from_task_reference":{"kind":"app_task","uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"},"uuid":"fd88e3c1-e408-fa94-f063-ffac774e1bb0","to_task_reference":{"kind":"app_task","uuid":"4c8163fc-5e8d-05be-484c-69453b24a920"}}]},"type":"DAG","variable_list":[],"name":"d8c7e7ce_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/name\/@@{TM_NAME}@@","response_paths":{"TM_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"6358683c-7c5b-7318-014e-cfbe0a299a12"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Resume TM","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\ntm_id = '@@{TM_ID}@@'\n\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\nurl = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/%s\/status?status=ready\" % tm_id\nresp_out = {}\n\n# Get time machine id\nresp = urlreq(url, verb='PATCH', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"Resp Code\", resp.status_code\n\nif resp.status_code != 200:\n  exit(1)\n"},"type":"EXEC","variable_list":[],"uuid":"4ba30e61-b19a-ffbe-6f73-eaa0978b0356"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get TM Status","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/tms\/@@{TM_ID}@@","response_paths":{"TM_STATUS":"$.status"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"eefa55d2-78d4-58e9-d5b0-123b19a9ce01"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Verify TM Status","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\ntm_status = \"@@{TM_STATUS}@@\"\nexpected_status = \"READY\"\n\nif tm_status != expected_status:\n  print \"Time Machine state(%s) is not in expected state(%s)\" % (tm_status, expected_status) \n  exit(1)\n  \nprint \"Time Machine state(%s) is in expected state(%s)\" % (tm_status, expected_status) "},"type":"EXEC","variable_list":[],"uuid":"4c8163fc-5e8d-05be-484c-69453b24a920"}],"name":"8b3015a4_runbook","variable_list":[{"val_type":"STRING","uuid":"ded581c2-87b8-3562-b228-b7abb24e0073","name":"TM_NAME","value":"era_pg_db_TM","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"6f4397cc-eb7c-413f-9278-88136002f443"},"name":"Resume Time Machine"},{"critical":false,"type":"user","uuid":"5e24e260-d31c-4e23-5667-d4478a9b9a5e","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"32c92916-a753-2f1f-0b43-37bea51a0cde"},"task_definition_list":[{"uuid":"32c92916-a753-2f1f-0b43-37bea51a0cde","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56"},{"kind":"app_task","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"},{"kind":"app_task","uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56"},"uuid":"9130e966-7185-eefd-992e-aca7ae8600c4","to_task_reference":{"kind":"app_task","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"}},{"from_task_reference":{"kind":"app_task","uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"},"uuid":"9815487a-13d0-2b7a-bfd1-2fed64e01fa3","to_task_reference":{"kind":"app_task","uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b"}}]},"type":"DAG","variable_list":[],"name":"c1aab0cf_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get DB ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases\/name\/@@{DBNAME}@@","response_paths":{"DB_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"c7b9ed54-e9c4-163d-74a3-97f718b7ee56"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Unregister DB","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases\/@@{DB_ID}@@?storage-cleanup=true&tm-cleanup=true","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"DELETE"},"type":"HTTP","variable_list":[],"uuid":"406089bb-d5c3-4845-26ac-f2ba2f4e4191"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Monitor Unregister DB Operation","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"type":"EXEC","variable_list":[],"uuid":"92338e82-77d7-b0fe-121b-81d0ff09bd5b"}],"name":"608d29d3_runbook","variable_list":[{"val_type":"STRING","uuid":"556f971d-4b07-d667-e677-63f56fd78bd3","name":"DBNAME","value":"era_pg_db","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"bfe6670c-c1ae-2d47-b89c-5e0e9aebe6a5"},"name":"Unregister Database"},{"critical":false,"type":"user","uuid":"7db15460-a773-d386-76ae-ed40fb506478","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"d4a22e7a-82e8-56f0-136e-55ce51b35c11"},"task_definition_list":[{"uuid":"d4a22e7a-82e8-56f0-136e-55ce51b35c11","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580"},{"kind":"app_task","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"},{"kind":"app_task","uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580"},"uuid":"9bcc66a1-6d0f-6e1e-4fd8-06aa04022038","to_task_reference":{"kind":"app_task","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"}},{"from_task_reference":{"kind":"app_task","uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"},"uuid":"b93078c6-4ae2-b9ee-db92-55aa6721c3b4","to_task_reference":{"kind":"app_task","uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432"}}]},"type":"DAG","variable_list":[],"name":"aa329bb8_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get DB Server ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/name\/@@{DB_SERVER_NAME}@@","response_paths":{"DB_SERVER_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"365c5be9-0ca9-3ff7-e199-f75db37fb580"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Unregister DB Server","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/@@{DB_SERVER_ID}@@?remove=true","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"DELETE"},"type":"HTTP","variable_list":[],"uuid":"23e722f5-9447-9ff9-bd3b-7b0708cee2f8"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Monitor Unregister DB Server Operation","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"type":"EXEC","variable_list":[],"uuid":"499ef8d6-65bf-23d6-de83-04bf3f9fa432"}],"name":"3af1d5ca_runbook","variable_list":[{"val_type":"STRING","uuid":"2d967732-1fc7-d0b8-7129-3321224d010f","name":"DB_SERVER_NAME","value":"lin-0-db-server","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"5e8eeb20-8e58-49f4-c670-f17a45e5b594"},"name":"Unregister Database  Server"},{"critical":false,"type":"user","uuid":"b1af722a-9b58-419e-be3e-468d8198ef09","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"9298a1dc-5c79-599e-e237-a3a3df555e0f"},"task_definition_list":[{"uuid":"9298a1dc-5c79-599e-e237-a3a3df555e0f","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"afa36105-29a1-26ec-7688-0271469f41ae"},{"kind":"app_task","uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"afa36105-29a1-26ec-7688-0271469f41ae"},"uuid":"05e60b8f-c648-cebd-906f-7a4c5f2301ab","to_task_reference":{"kind":"app_task","uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378"}}]},"type":"DAG","variable_list":[],"name":"bf3021fc_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get DB Server ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers\/name\/@@{DB_SERVER_NAME}@@","response_paths":{"SOURCE_DBSERVER_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"afa36105-29a1-26ec-7688-0271469f41ae"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Create Profile","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n\t\"engineType\":\"@@{DB_ENGINE}@@\",\n    \"type\":\"@@{PROFILE_TYPE}@@\",\n    \"dbVersion\":\"ALL\",\n\t\"properties\":[\n\t\t{\n        \t\"name\":\"SOURCE_DBSERVER_ID\",\n\t\t\t\"value\":\"@@{SOURCE_DBSERVER_ID}@@\",\n\t\t\t\"description\":\"ID of the database server that should be used as a reference to create the software profile\"\n\t\t}\n     ],\n\t\"name\":\"@@{PROFILE_NAME}@@\",\n\t\"description\":\"@@{PROFILE_DESCRIPTION}@@\"\n}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/profiles","retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"8a5555b1-b8df-87d7-b28d-1eed94b50378"}],"name":"a74dcd1e_runbook","variable_list":[{"val_type":"STRING","uuid":"67b3b634-4266-7c64-e7b0-44a484290ee6","name":"DB_SERVER_NAME","value":"lin-0-190228-223012","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"b94c09ce-6fa0-3785-f332-5760675263b2","name":"DB_ENGINE","value":"postgres_database","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"df4eb2a7-077c-c202-0440-ccd9cb749495","name":"PROFILE_TYPE","value":"Software","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"88a0fd9b-1dd0-a8a8-c037-bb89f1d37c41","name":"PROFILE_NAME","value":"TEST_PROFILE","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"de5c335c-371d-fe18-19f0-bb663d1a0161","name":"PROFILE_DESCRIPTION","value":"Sample test profile","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"fbf5a324-7830-d4d7-c921-f52139feb818"},"name":"Create Profile"},{"critical":false,"type":"user","uuid":"0f4e3512-64d0-af3e-3b74-863e456a0b13","runbook":{"main_task_local_reference":{"kind":"app_task","uuid":"a844e0c9-4de1-0f8e-67c7-205366b53f47"},"task_definition_list":[{"uuid":"a844e0c9-4de1-0f8e-67c7-205366b53f47","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70"},{"kind":"app_task","uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc"}],"attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70"},"uuid":"10516184-b4b7-4b13-4ff7-a117f7a3f9d1","to_task_reference":{"kind":"app_task","uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc"}}]},"type":"DAG","variable_list":[],"name":"ca61e0c0_dag"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get Profile ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"url":"https:\/\/10.46.35.84:8443\/era\/v0.8\/profiles?type=@@{PROFILE_TYPE}@@&engine=@@{DB_ENGINE}@@&name=@@{PROFILE_NAME}@@","response_paths":{"PROFILE_ID":"$.id"},"retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"b980d0f7-7692-1bdc-8b13-55101610ad70"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Delete Profile","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{}","url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/profiles\/@@{PROFILE_ID}@@","retry_interval":1,"retry_count":1,"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false}}}},"content_type":"application\/json","connection_timeout":60,"method":"DELETE"},"type":"HTTP","variable_list":[],"uuid":"5115e856-c8f0-6b3c-c135-b3f226aabbbc"}],"name":"309b14fd_runbook","variable_list":[{"val_type":"STRING","uuid":"f997a53c-b873-4478-1255-f27ccc1e43f4","name":"PROFILE_NAME","value":"PG_Profile","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"d46eb8d1-e4f1-edc1-a38d-25ead3192357","name":"PROFILE_TYPE","value":"Software","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"35822173-51d5-4a15-b64e-7dce863d2cc5","name":"DB_ENGINE","value":"postgres_database","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"aa6d3c17-0eb7-ba36-b252-ffaf524659c2"},"name":"Delete Profile"}],"name":"Nutanix","variable_list":[{"val_type":"STRING","uuid":"519f4e76-cf05-4714-8b43-6a9bfde724fd","name":"DB_NAME","value":"era_pg_db","label":"","editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"592675ee-599e-488d-95a2-4e370fc7b7f3","name":"DB_PASSWORD","label":"","attrs":{"is_secret_modified":false,"secret_reference":{"uuid":"879849f2-54a0-4977-9b75-4dcfc66cf1e8"}},"editables":{"value":true},"type":"SECRET","description":""},{"val_type":"STRING","uuid":"e1845647-e8de-454c-a29d-2a622528d60d","name":"DB_USER","value":"postgres","label":"","attrs":{"type":""},"editables":{},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"94bbfdd0-96f5-4e41-a046-6a2fe71c50de","name":"ERA_IP","value":"10.46.35.90","label":"","attrs":{"type":""},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"391729fc-985d-4b56-a7cc-3ebb05217fe7","name":"SLA_NAME","value":"BRONZE","label":"","attrs":{"type":""},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"7a9a6b0f-d7a1-9371-6c88-01e3d78791b9","name":"PG_SOFTWARE_HOME","value":"\/usr\/pgsql-","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"9fe243cc-91d4-ce80-be91-6aecdde63016","name":"DB_VERSION","value":"9.6","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"type":"LOCAL","options":{"type":"PREDEFINED","choices":["9.6","10.4"]},"description":""},{"val_type":"STRING","uuid":"b4cafd8b-c7df-5a76-2d03-5b50ee6fd90f","name":"DB_PORT","value":"5432","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"b9952629-7fd0-0257-f750-0cbeb3493d31","name":"SNAPSHOT_PER_DAY","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"a3392a50-9a37-c56e-8616-b4b50ce88276","name":"LOG_CATCHUP_INTERVAL_IN_MINUTE","value":"30","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"b23f3505-05dd-ae5c-d4fa-cbfab40fc1c7","name":"DAY_OF_WEEK","value":"MONDAY","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"0cf89336-35df-e632-e9b4-16645278cadc","name":"DAY_OF_MONTH","value":"25","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"f9cfbada-f89b-3d9a-06c6-bbe41ebccc21","name":"QUARTER_START_MONTH","value":"FEBRUARY","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"c7cc0a4d-0f7e-52ff-e69a-3ff6378d7901","name":"SCHEDULE_HOURS","value":"1","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"f7f37756-8747-c111-2b6f-e22d1e082316","name":"SCHEDULE_MINUTES","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""},{"val_type":"STRING","uuid":"dff97fef-eb42-8a22-1ddb-5de5b2441917","name":"SCHEDULE_SECONDS","value":"0","label":"","attrs":{},"editables":{"value":true},"type":"LOCAL","description":""}],"uuid":"1aa800e6-3061-4105-b1f5-3bfcac5d4bc9"}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"era_creds","uuid":"6f127226-e987-443c-ac4c-daa9796b9af8"},"package_definition_list":[{"uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8","action_list":[],"service_local_reference_list":[{"kind":"app_service","name":"Postgres","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"}],"name":"PostgresPackage","version":"","type":"DEB","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","name":"58ca4a03_dag","type":"DAG","description":"","child_tasks_local_reference_list":[{"kind":"app_task","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},{"kind":"app_task","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},{"kind":"app_task","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},{"kind":"app_task","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},{"kind":"app_task","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},{"kind":"app_task","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},{"kind":"app_task","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},{"kind":"app_task","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},{"kind":"app_task","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},{"kind":"app_task","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},{"kind":"app_task","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},{"kind":"app_task","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"},{"kind":"app_task","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"}],"state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},"uuid":"56b15a2e-857f-8b7c-5c54-361845d0aa9f","to_task_reference":{"kind":"app_task","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"}},{"from_task_reference":{"kind":"app_task","uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},"uuid":"523547e8-36f0-a840-5d60-772cd46baead","to_task_reference":{"kind":"app_task","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"}},{"from_task_reference":{"kind":"app_task","uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},"uuid":"7e4989fd-19da-1dd0-ed1c-9d7a1fb256ba","to_task_reference":{"kind":"app_task","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"}},{"from_task_reference":{"kind":"app_task","uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},"uuid":"68b15b8f-c3ec-6bed-c7f6-55339fa828ea","to_task_reference":{"kind":"app_task","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"}},{"from_task_reference":{"kind":"app_task","uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},"uuid":"701afd40-3386-42d2-7c23-29e10c83745a","to_task_reference":{"kind":"app_task","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"}},{"from_task_reference":{"kind":"app_task","uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},"uuid":"ed214671-6b3e-e9b3-f016-aa9569df35ed","to_task_reference":{"kind":"app_task","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}},{"from_task_reference":{"kind":"app_task","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},"uuid":"c9987dd9-bd3c-12e2-eac4-fabccc53bd41","to_task_reference":{"kind":"app_task","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"}},{"from_task_reference":{"kind":"app_task","uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},"uuid":"a6a75362-5fe1-7bd8-68f8-94b6765dbd40","to_task_reference":{"kind":"app_task","uuid":"830ebb80-f852-fc97-1570-668e266cca32"}},{"from_task_reference":{"kind":"app_task","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},"uuid":"89988f4e-2a4c-4f20-5c6e-48d1d8841d8e","to_task_reference":{"kind":"app_task","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"}},{"from_task_reference":{"kind":"app_task","uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},"uuid":"4cf60df5-81c6-f85e-2373-c35e9bc6c5f2","to_task_reference":{"kind":"app_task","uuid":"db4594dd-072b-205e-a085-f1fb145fe627"}},{"from_task_reference":{"kind":"app_task","uuid":"830ebb80-f852-fc97-1570-668e266cca32"},"uuid":"b92c3b3d-03ff-9380-bd96-62626569bfd3","to_task_reference":{"kind":"app_task","uuid":"264bebed-214b-d30c-5318-6593a4f889f9"}},{"from_task_reference":{"kind":"app_task","uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"},"uuid":"abc143d3-83b8-bf9e-25cb-1699dab49062","to_task_reference":{"kind":"app_task","uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"}}],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Install System Packages","child_tasks_local_reference_list":[],"attrs":{"script":"#!\/bin\/bash\n\nsudo yum -y upgrade\nsudo curl -O http:\/\/dl.fedoraproject.org\/pub\/epel\/7\/x86_64\/e\/epel-release-7-10.noarch.rpm\nsudo rpm --import https:\/\/www.elrepo.org\/RPM-GPG-KEY-elrepo.org\nsudo rpm -Uvh http:\/\/www.elrepo.org\/elrepo-release-7.0-3.el7.elrepo.noarch.rpm \nsudo rpm -ihv epel-release-7-10.noarch.rpm \n\nsudo yum update -y\nsudo yum -y install htop wget iotop xfs* bc unzip lvm2*\n\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/sysconfig\/selinux\nsudo sed -i 's\/^SELINUX=.*\/SELINUX=disabled\/' \/etc\/selinux\/config\nsudo setenforce 0\n\necho \"System packages are installed\"\n","script_type":"sh","login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"type":"EXEC","variable_list":[],"uuid":"744380ed-1bf5-5e39-39db-f32104e0c195"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Create Disk Setup","child_tasks_local_reference_list":[],"attrs":{"login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"},"script_type":"sh","script":"#!\/bin\/bash\n\n##############\n#\n# LVM setup script for PostgreSQL . 4 disks for DATA and 2 for logs\n# Data disks are 60GB | Log disks are 20GB \n#\n#############\n\n\n#PGSQL data\nsudo pvcreate \/dev\/sdb \/dev\/sdc \/dev\/sdd \/dev\/sde\nsudo vgcreate pgDataVG \/dev\/sdb \/dev\/sdd \/dev\/sdc \/dev\/sde\nsudo lvcreate -l 100%FREE -i4 -I1M -n pgDataLV pgDataVG          ## Use 1MB to avoid IO amplification \n#lvcreate -l 100%FREE -i4 -I4M -n pgDataLV pgDataVG\n\n\n#PGSQL logs\nsudo pvcreate \/dev\/sdf \/dev\/sdg \nsudo vgcreate pgLogVG \/dev\/sdf \/dev\/sdg\nsudo lvcreate -l 100%FREE -i2 -I1M -n pgLogLV pgLogVG            ## Use 1MB to avoid IO amplification\n#lvcreate -l 100%FREE -i2 -I4M -n pgLogLV pgLogVG\n\n\n#Disable LVM read ahead\nsudo lvchange -r 0 \/dev\/pgDataVG\/pgDataLV\nsudo lvchange -r 0 \/dev\/pgLogVG\/pgLogLV\n\n\n#Format LVMs with ext4 and use nodiscard to make sure format time is fast on Nutanix due to SCSI unmap\nsudo mkfs.ext4 -E nodiscard \/dev\/pgDataVG\/pgDataLV\nsudo mkfs.ext4 -E nodiscard \/dev\/pgLogVG\/pgLogLV\n\n\n"},"type":"EXEC","variable_list":[],"uuid":"2b35d026-ff80-f38c-5664-914e1fcaf5a1"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Install Postgresql","child_tasks_local_reference_list":[],"attrs":{"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.5\/redhat\/rhel-7-x86_64\/pgdg-centos95-9.5-3.noarch.rpm\n  sudo yum -y install pgdg-centos95-9.5-3.noarch.rpm\n\n  # Install PostgreSQL 9.5\n  sudo yum -y install postgresql95 postgresql95-contrib postgresql95-server postgresql95-plpython\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/9.6\/redhat\/rhel-7-x86_64\/pgdg-centos96-9.6-3.noarch.rpm\n  sudo yum -y install pgdg-centos96-9.6-3.noarch.rpm\n\n  # Install PostgreSQL 9.6\n  sudo yum -y install postgresql96 postgresql96-contrib postgresql96-server postgresql96-plpython\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n\n  sudo wget -c https:\/\/download.postgresql.org\/pub\/repos\/yum\/10\/redhat\/rhel-7-x86_64\/pgdg-centos10-10-2.noarch.rpm\n  sudo yum -y install pgdg-centos10-10-2.noarch.rpm\n\n  # Install PostgreSQL 10\n  sudo yum -y install postgresql10 postgresql10-contrib postgresql10-server postgresql10-plpython  \n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n\n\n\n","script_type":"sh","login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"type":"EXEC","variable_list":[],"uuid":"f1050f98-a6e9-a550-dc92-ccacf2492e9b"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Setup Postgresql","child_tasks_local_reference_list":[],"attrs":{"script":"#!\/bin\/bash\n\nDB_VERSION=\"@@{DB_VERSION}@@\"\n\nif [[ $DB_VERSION = \"9.5\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.5\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.5\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.5\/bin\/postgresql95-setup\"\n\nelif [[ $DB_VERSION = \"9.6\" ]]\nthen\n    SERVICE_NAME=\"postgresql-9.6\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/9.6\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-9.6\/bin\/postgresql96-setup\"\n  \n  \nelif [[ $DB_VERSION = \"10.2\" ]]\nthen\n    SERVICE_NAME=\"postgresql-10.2\"\n    PG_DATA_HOME=\"\/var\/lib\/pgsql\/10.2\/data\"\n    PG_SETUP_CMD=\"\/usr\/pgsql-10.2\/bin\/postgresql10-setup\"\n\nelse\n\techo \"Unsupported PG Version : $DB_VERSION \"\n    exit 1\nfi\n\n\n#run initdb\nsudo $PG_SETUP_CMD initdb\n\n#start and stop postgresql to make sure DB creates the required directories\nsudo systemctl start $SERVICE_NAME\nsudo systemctl stop $SERVICE_NAME\n\n##copy the created postgres directory to a temp directory\nsudo mkdir \/tmp\/pgsql\n\nsudo mv $PG_DATA_HOME \/tmp\/pgsql\n\n#Create directory , fix permissions and Mount LVM\nsudo mkdir $PG_DATA_HOME\/\nsudo mount -o noatime,barrier=0 \/dev\/pgDataVG\/pgDataLV $PG_DATA_HOME\/ \n\nsudo mkdir $PG_DATA_HOME\/pg_xlog\nsudo mount -o noatime,barrier=0 \/dev\/pgLogVG\/pgLogLV $PG_DATA_HOME\/pg_xlog\n\nsudo chown -R postgres:postgres $PG_DATA_HOME\/\n\n#move the xlog to the new LVM\nsudo find \/tmp\/pgsql\/data\/pg_xlog -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/pg_xlog\/ {} +\n\n#remove pg_xlog from temp dir to avoid being copied again\nsudo rm -rf \/tmp\/pgsql\/data\/pg_xlog\n\n#move the pgsql directory to the LVM\nsudo find \/tmp\/pgsql\/data -maxdepth 1 -mindepth 1 -exec mv -t $PG_DATA_HOME\/ {} +\n\nsudo chmod -R 0700 $PG_DATA_HOME\n\n#enable service on boot\nsudo systemctl enable $SERVICE_NAME\n\n#add mount points to \/etc\/fstab\necho \"\/dev\/mapper\/pgDataVG-pgDataLV $PG_DATA_HOME ext4 rw,seclabel,noatime,nobarrier,stripe=4096,data=ordered 0 0\" | sudo tee -a \/etc\/fstab\necho \"\/dev\/mapper\/pgLogVG-pgLogLV $PG_DATA_HOME\/pg_xlog ext4 rw,seclabel,noatime,nobarrier,stripe=2048,data=ordered 0 0\" | sudo tee -a  \/etc\/fstab\n\n\nsudo systemctl status $SERVICE_NAME\nsudo systemctl restart $SERVICE_NAME\nsudo systemctl status $SERVICE_NAME\n","script_type":"sh","login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"type":"EXEC","variable_list":[],"uuid":"7f3f47fa-87fc-edb9-eee1-804ea9fbb1a1"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Create DB and User","child_tasks_local_reference_list":[],"attrs":{"script":"#!\/bin\/bash\n\nDB_USER=\"@@{DB_USER}@@\"\nDB_NAME=\"@@{DB_NAME}@@\"\nDB_PASSWORD=\"@@{DB_PASSWORD}@@\"\n\n#sudo -i -u postgres sh -c \"createuser -d -E -R -S ${DB_USER}\";\nsudo -i -u postgres sh -c \"createdb -O ${DB_USER} -E UTF-8 -T template0 ${DB_NAME}\";\nsudo -i -u postgres psql -c \"ALTER USER postgres PASSWORD '${DB_PASSWORD}' ; \"\n#sudo -i -u postgres psql -c \"ALTER USER ${DB_USER} PASSWORD '${DB_PASSWORD}' ; \"\n\n\n","script_type":"sh","login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"type":"EXEC","variable_list":[],"uuid":"33fab652-fa53-6acb-52a7-4b692147976d"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Configure Era Access","child_tasks_local_reference_list":[],"attrs":{"script":"#!\/bin\/bash\n\necho \"local   all             postgres                                     trust\nhost    all             postgres             ::1\/128                 md5\nhost    all             postgres              127.0.0.1\/32           md5\" | sudo tee \/var\/lib\/pgsql\/9.6\/data\/pg_hba.conf\necho \"listen_addresses = '*'\" | sudo tee -a \/var\/lib\/pgsql\/9.6\/data\/postgresql.conf \nsleep 2;\n\nsudo systemctl restart postgresql-9.6\n\n","script_type":"sh","login_credential_local_reference":{"kind":"app_credential","uuid":"ea08d651-24d5-48c6-b5a3-af69b78581d8"}},"type":"EXEC","variable_list":[],"uuid":"d9f8432e-2d4b-67cb-eb93-43d63c4527e1"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get Cluster ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/clusters","response_paths":{"CLUSTER_ID":"$[0].id"},"retry_interval":1,"headers":[{"val_type":"STRING","uuid":"608b3a71-32a9-5653-c535-193b9cf734d0","value":"@@{TOKEN}@@","attrs":{},"type":"LOCAL","name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false},"value":"Nutanix.123"}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"6905e6ab-eae6-cc31-5c52-2fe1245a2110"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Register DB Server","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"},{"status":"FAILURE","code":"400"},{"status":"FAILURE","code":"422"}],"request_body":"{\n    \"status\": \"8\",\n    \"timeMachineId\": null,\n    \"forcedInstall\": true,\n    \"ownerId\": \"1\",\n    \"type\": \"register_host\",\n    \"actionArguments\": [],\n    \"vmInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"application_version\",\n        \"value\": \"@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }],\n    \"actionHeader\": [{\n        \"name\": \"cloudId\",\n        \"value\": \"@@{CLUSTER_ID}@@\"\n    }, {\n        \"name\": \"cloudName\",\n        \"value\": null\n    }, {\n        \"name\": \"host_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_name\",\n        \"value\": \"\"\n    }, {\n        \"name\": \"host_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"host_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }]\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/dbservers","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"val_type":"STRING","uuid":"03aeafdc-017e-8466-ccde-72a86a90b411","value":"@@{TOKEN}@@","attrs":{},"type":"LOCAL","name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false},"value":"Nutanix.123"}}},"tls_verify":false,"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"16dd0150-e1ca-b35c-f5bd-38b462cbbaf7"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Monitor Register DB Servers Operation","child_tasks_local_reference_list":[],"attrs":{"script_type":"static","script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n "},"type":"EXEC","variable_list":[],"uuid":"830ebb80-f852-fc97-1570-668e266cca32"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get SLA ID","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/slas\/name\/@@{SLA_NAME}@@","response_paths":{"SLA_ID":"$.id"},"retry_interval":1,"headers":[{"val_type":"STRING","uuid":"5fd2c982-787b-a190-0e53-436549ee4ce9","value":"@@{TOKEN}@@","attrs":{},"type":"LOCAL","name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false},"value":"Nutanix.123"}}},"content_type":"application\/json","connection_timeout":60,"method":"GET"},"type":"HTTP","variable_list":[],"uuid":"264bebed-214b-d30c-5318-6593a4f889f9"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Register Database","child_tasks_local_reference_list":[],"attrs":{"expected_response_params":[{"status":"SUCCESS","code":"200"}],"request_body":"{\n    \"vmAdd\": true,\n    \"applicationInfo\": [{\n        \"name\": \"application_type\",\n        \"value\": \"postgres_database\"\n    }, {\n        \"name\": \"listener_port\",\n        \"value\": \"@@{DB_PORT}@@\"\n    }, {\n        \"name\": \"db_user\",\n        \"value\": \"@@{DB_USER}@@\"\n    }, {\n        \"name\": \"working_dir\",\n        \"value\": \"\/tmp\"\n    }, {\n        \"name\": \"switch_log\",\n        \"value\": true\n    }, {\n        \"name\": \"allow_multiple_databases\",\n        \"value\": true\n    }, {\n        \"name\": \"era_deploy_base\",\n        \"value\": \"\/opt\/era_base\"\n    }, {\n        \"name\": \"create_era_drive\",\n        \"value\": true\n    }, {\n        \"name\": \"vm_ip\",\n        \"value\": \"@@{address}@@\"\n    }, {\n        \"name\": \"vm_username\",\n        \"value\": \"@@{db_server_cred.username}@@\"\n    }, {\n        \"name\": \"vm_ssh_private_key\",\n        \"value\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\"\n    }, {\n        \"name\": \"postgres_software_home\",\n        \"value\": \"@@{PG_SOFTWARE_HOME}@@@@{DB_VERSION}@@\"\n    }, {\n        \"name\": \"database_name\",\n        \"value\": \"@@{DB_NAME}@@\"\n    }, {\n        \"name\": \"db_password\",\n        \"value\": \"@@{DB_PASSWORD}@@\"\n    }],\n    \"forcedInstall\": true,\n    \"clusterId\": \"@@{CLUSTER_ID}@@\",\n    \"tags\": [],\n    \"timeMachineInfo\": {\n        \"name\": \"@@{DB_NAME}@@_TM\",\n        \"description\": \"\",\n        \"slaId\": \"@@{SLA_ID}@@\",\n        \"schedule\": {\n            \"snapshotTimeOfDay\": {\n                \"hours\": @@{SCHEDULE_HOURS}@@,\n                \"minutes\": @@{SCHEDULE_MINUTES}@@,\n                \"seconds\": @@{SCHEDULE_SECONDS}@@\n            },\n            \"continuousSchedule\": {\n                \"enabled\": true,\n                \"logBackupInterval\": \"@@{LOG_CATCHUP_INTERVAL_IN_MINUTE}@@\",\n                \"snapshotsPerDay\": @@{SNAPSHOT_PER_DAY}@@\n            },\n            \"weeklySchedule\": {\n                \"enabled\": true,\n                \"dayOfWeek\": \"@@{DAY_OF_WEEK}@@\"\n            },\n            \"monthlySchedule\": {\n                \"enabled\": true,\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"quartelySchedule\": {\n                \"enabled\": true,\n                \"startMonth\": \"@@{QUARTER_START_MONTH}@@\",\n                \"dayOfMonth\": \"@@{DAY_OF_MONTH}@@\"\n            },\n            \"yearlySchedule\": {\n                \"enabled\": false,\n                \"dayOfMonth\": 31,\n                \"month\": \"DECEMBER\"\n            }\n        },\n        \"tags\": [],\n        \"autoTuneLogDrive\": true\n    },\n    \"applicationSlaName\": \"@@{SLA_NAME}@@\",\n    \"applicationType\": \"postgres_database\",\n    \"autoTuneStagingDrive\": true,\n    \"eraBaseDirectory\": \"\/opt\/era_base\",\n    \"applicationHost\": \"@@{address}@@\",\n    \"vmIp\": \"@@{address}@@\",\n    \"vmUsername\": \"@@{db_server_cred.username}@@\",\n    \"vmSSHPrivateKey\": \"-----BEGIN RSA PRIVATE KEY-----\\nMIIJKQIBAAKCAgEAzBgEvytDG\/7sBV8A\/oZI4Lsu1TGZNoabocD5fRVGcFQa1EX\/\\n4vUDCef6WjxGYsbvFZUceyJ7uIrp+60H6533iGCJ5gcLKVx2Ikyt6ByQIGZ6wB1R\\nH9aemGsSyDZU9TSOcjgBj0VluqH\/KwQwR9Tm8FNvsHEsf9R9LiLN2mTS7n6\/kYet\\nvAAsQLpthrfAFUY+rmtgTxcreVU3XJcsrAJnodQIosTYDmVzs+sv4uE286WO\/CN4\\nrLiqcbFHl1+o8RDEKJeNOoxw1Bep4xDjyEBts1Wd0CZUxvTpTfjYsmRvVpGc9FRv\\n+jPIscSBxyNnTcFGwRb9h1LvvF\/S0yxatjuyo1\/R6e7mSgQMkhwN3imihyKdm2bl\\nNW0+T0T5IIJ4F\/OsYPk\/jjDZ7rWwIjJ0SfPhbw+UqPuUyMeG\/RoMQMbq3t8dskT0\\n\/ZTokDgfglaST8UdEZ\/WziPsIj5w9JABryv3x0\/qai+DzPoU5ybafa6wkcyEAKQc\\nddut4xHGH34VtnqWUETvoXuQjGsBSeUwXtPKJtgGgyfBkHa6RemAN1vA8x25i9wz\\n1VR3Zqjy59dKPi1+IL+UnSCA1RnYyjnNQQpy00ZjNvHefrCw7fzPpL3EIH9MtMg4\\nzFYxhAmZLd\/YW5uBCzB82bc2C5hzYQWcUah3ie6hU7r9ZMfPDlt13OZmwTUCAwEA\\nAQKCAgEApuK49uzUOk8wBZBSys1ZSFInEHM3GivllNWr7Ej6SR2stojqnVXFf1Mu\\nFp0U3O5YT6iXGmTvD86fV4l8YYDRCLYP7IUz7kVJ3\/AdgB\/jBmtl0jPmwwcGthFP\\n0WEEBWFNXT5IoDOZ5ItUkIMjS4lesYM4X+ma\/oftOE2DUCKDjDseQEzWllT52o\/W\\nwYL9USgYVx08KlAC33r8Av0mrRxmSyCLUzVsihERFDyq8nVALujgy3Hh2jJCRSc2\\nKCQzi7MvAxYxiH+QPw1+gEquR2\/PhAXtPmgpiGp5X6Ws4+pWVE5LLkrhKZEweZP6\\nnrBnZ2A0j+1RsFbz62\/bf4vUPREBlzixGfFBrGOgmLnsMw7uwD+8aV2\/gJf+i13L\\nULvFqaEIxR+6tu+v1\/fZG3cETycaAfJ87YjF8vBSjiIW5WERAK5wjblbn3VB0jGw\\nA56LneVuSADIMtk\/36qK80smtUzCupbulg6h9hbJsBLkKpN4CuRYtPUeDL7GTpYR\\nV2NpS3WLdSGk4ZSck1ZFP6cnzTGkAeIi+CasABATBBJixRBlhALTND5QM6dVy\/Ok\\nMnI06Upwt94X9XmhzyCEPFr+kMmTNwsAT1Ae0WM20zLVwErhDKFyItw1ptDBXnxa\\nq+SVAYUrGD4IA0FeEvHDWJk6Qe\/JHxQjz9w0\/zFE93UMlIXBAB0CggEBAPkF5MYA\\n49R+jvSd3vm4lKyr0NgxF1PVVm5nk67KeleRFtmXllKJAvvqWzEjET\/eSHzwj0Ai\\n2owGw+XTkMWzEqnWOtqJb90DpNpWZYF9c\/GZePUkyntR8v8hiCYSni4lSiqSUFDY\\nj5Upyw3r+YleDNhzEfUnw7x5QiJ1tPuFRNIK6LJwvW6o9m0m3SHTMRSqAWW5toeW\\nft6pMNtiUYmDunuluiTd7RlIFTvACaoDDNnBdmP8lut\/q7NUJr4i2A8uheYW8Si2\\nozmIpQNGsbA6v\/J1crmScqIhPJ9VQOl5RZwjFBadqS8R5bmVjTx5McgZ5rCRqryh\\ny2tw0o8BjIBWZE8CggEBANHP30t0mWUT0mzW7J9qw\/jxmYPU310v10l2z2Ztxcgo\\nu0bEWvjjKyhQdbjiGIXNes9QyHOHPOLV5ggXJ6IQ3FpEYmu3xLBiHsjdAMTcsm6z\\nunR0iOdzfY5qg+SMM79Xp1MTETZwP63KEm44jKkLCuumm2QIImw8bsYC\/JSgwiYD\\n9gUlYF9AZHagA\/\/ZdUMuyRv21Eoy5lApVIHnptC2ZSsbhQH+p1FAvSEDRyqBc6o9\\nm4LvII4BXQ73ayjzV9X4024bWoVmxieYABZeqXQwqfoCHKfZVNy666wWlvuhqfP5\\nuuxfnttrNyGKAud92HuC6MRf5+X55pOa3agBQT+4bTsCggEAJ8aNOCNEQNjGNMRS\\nrUiSVtJK1X1h4H4fBBt\/N1gYGoyOPcs8s4o2884HKt4TD0SOB4bVGsV2aw9Zkwgs\\nA6gKvx384JM7Tu4aEtXh+MD1GA4Ph\/iMbw4z5hSRDqPCqFREeHBOa9trc8PtLxgW\\nD576JkibAbGMTjqAGcj7U4GB8JrVeEsRtu8+DUk74P8+w7Iz7u+u\/BFJyn7z0tbt\\ndy2XR9C83s6j5HnjClwuLv21u8JvCqF56bvGzSoP1ibyo9omgQ4BDyO9Bp+Q2+ka\\n0K9RoYSpAoMl1EfCyyBu8dvxBnOD7ejY8S\/GpdIBcTtafD\/G3UUnJGIjf9HRkA4L\\nRySFeQKCAQBdZ6WI+gewL\/rl6Wi+L9G+6g\/l2Mb3vWyij\/oVJ5l9WmTFRHUbiEaW\\nU\/uUq1MvfiLGWLhkdjhs47zcrTI\/vDHdHcSTH+S4gXYjBgBpo7bsAadoYNjx8UBc\\nPp8pCCGhdWxQV5S6H46519QMrbAxMXFTJ4DWL6jjdqP6EypPIKJOOkU0VUdqIEiZ\\nZvNg23aQyitN\/7zSq4ZM+Zldm7tv\/0NaxY2ZLb1fNur733G3Qpozl+m7iKl9jq3X\\nE97pBCx+XaACzLqn2PEuf0TKsKnPyDpjyrznHKHjAnQY0JW2wGng67SDtq4KENki\\nXUaduDDAC6+EfQ3IHFDCNZeoS6a4r2oxAoIBAQCls3dZKm7zVnqkbddRv2+ceQZS\\nkjAx2f3kHqDZA3cRQOBngZW3avLYB6OzcQC6AW+4L+P+F8Qa8DE4n0vcjcbHXGUp\\nmA\/5GWOC3th3WDTrJg9Bx2HQdXyWym2\/owGYOrLr4EW+8HnwKhHpYTdpvY\/IHpuu\\nHrtqft1EngJDur+x31y4FSoMcqqlMMtsDfhDZOzW4VZ9Q05\/eGKDsbvWeKMYG3IJ\\n6ppmBQNagfPh90Qsw\/1pGX21BS9KLkqaNqRtXd6thLdHXiQf+VHLJO1sIvanFrGZ\\nmbyFx04DUH4mLQ99Pe4nrld1k\/JfZjJMSGAc8nXBnvjrz8fpGrzueG9sbhl0\\n-----END RSA PRIVATE KEY-----\",\n    \"applicationName\": \"@@{DB_NAME}@@\",\n    \"vmDescription\": \"@@{DB_NAME}@@\"\n}","retry_count":1,"url":"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/databases","response_paths":{"OPERATION_ID":"$.operationId"},"retry_interval":1,"headers":[{"val_type":"STRING","uuid":"8430aab9-9bdb-e6c9-ca61-70f59184f759","value":"@@{TOKEN}@@","attrs":{},"type":"LOCAL","name":"Authorization"}],"authentication":{"auth_type":"basic","basic_auth":{"username":"@@{era_web_cred.username}@@","password":{"attrs":{"is_secret_modified":false},"value":"Nutanix.123"}}},"content_type":"application\/json","connection_timeout":60,"method":"POST"},"type":"HTTP","variable_list":[],"uuid":"abeb71ba-254f-9782-2525-edc253625d5e"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Monitor Register DB Operation","child_tasks_local_reference_list":[],"attrs":{"script":"\n# Set creds, headers, and URL\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/operations\/@@{OPERATION_ID}@@\"\nresp_out = {}\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  resp_out = json.loads(resp.content)\n  print \"Percentage Complete: {0}\".format(resp_out['percentageComplete'])\n  \n  \n  # If complete, break out of loop\n  if resp_out['percentageComplete'] == \"100\" or resp_out['status'] == \"5\" :\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif 'percentageComplete' not in resp_out or 'status' not in resp_out:\n  exit(1)\nelif resp_out['percentageComplete'] != \"100\" or resp_out['status'] != \"5\" :  \n  exit(1)\n ","script_type":"static"},"type":"EXEC","variable_list":[],"uuid":"db4594dd-072b-205e-a085-f1fb145fe627"},{"target_any_local_reference":{"kind":"app_service","uuid":"06f3fc75-64a7-46fe-b061-62f48048a548"},"name":"Get Token","child_tasks_local_reference_list":[],"attrs":{"eval_variables":["TOKEN"],"script_type":"static","script":"# Set creds and headers\nera_user = '@@{era_web_cred.username}@@'\nera_pass = '@@{era_web_cred.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{ERA_IP}@@:8443\/era\/v0.8\/auth\/validate?token=true&expire=15\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"TOKEN={0}\".format(json.loads(resp.content)['token'])"},"type":"SET_VARIABLE","variable_list":[],"uuid":"b6de26d3-22c8-313c-2c76-458377a385cd"}],"name":"8b1f1a7b_runbook","description":"","state":"ACTIVE","variable_list":[],"message_list":[],"main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag","uuid":"a70c97c4-fa17-461c-83f5-702ef4f4df98"},"uuid":"2c8ef6b0-d9ab-46cc-884e-84eb527a07d0"},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2","uuid":"2338f9d7-6e48-4ed5-84e0-c7fea732d1d8"},"retries":"0","name":"ee8bedbe_dag","type":"DAG","description":"","child_tasks_local_reference_list":[],"state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","message_list":[],"variable_list":[],"uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9"}],"name":"faacff5d_runbook","description":"","state":"ACTIVE","variable_list":[],"message_list":[],"main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag","uuid":"d181ab7c-f3ad-44ef-9d6f-00b7dd5e1bb9"},"uuid":"af16f04e-9e2e-42b7-ab1d-1d41d0700084"}},"variable_list":[],"description":""}],"client_attrs":{"None":{"y":443,"x":658.75},"feefe42c-ea67-00f6-2c52-bf0f40843473":{"y":-99.8842996936,"x":252.4837106672},"61a62ae3-79c4-49d8-9355-1b1e3dd1aa97":{"y":244,"x":509},"6fcec168-0a62-4996-5f26-a98f8d665b40":{"y":27.9153327942,"x":452.9511108398},"0be9f2ad-b93e-c838-a4eb-ba0ac39724d2":{"y":-178.5636183077,"x":781.8389902745},"55d915ec-e34e-4bd5-aa49-1f070f437760":{"y":-165.08483127,"x":430.331372126}}},"description":""},"api_version":"3.0","metadata":{"last_update_time":"1558509310156733","owner_reference":{"kind":"user","uuid":"00000000-0000-0000-0000-000000000000","name":"admin"},"kind":"blueprint","uuid":"88730303-a4a0-4b3f-8b0f-6aa3b29d6537","project_reference":{"kind":"project","name":"default","uuid":"209e0a42-6f2d-4999-9a9b-5aa705d25661"},"spec_version":373,"creation_time":"1549429257786471","name":"EraPostgres"}}